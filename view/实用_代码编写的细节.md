//后续可选的需要做的事情：

- //排查问题要上一个台阶的话，前端可能真要学习下；
- quickBi玩一玩，导出切片表数据吗?(电子表格有数量限制1000条)；//明年可能需要了解下dataworks开发
- 要不要学习下蓝湖的用法；（mastergo可能需要找个b站视频学习下；或者有一篇好的教程；
- spring完结之后再整
  -  java中如何自己发布和监听事件？AOP？ 项目中有没有应用场景； 代理有没有应用场景？21设计模式都强行应用下？
- 异常的处理模式(全局处理器 + 事务注解+自定义RestException实现更好地提示效果)、防重注解体现的注解的使用模式，都可以抽离总结下；自己设计的表头层级的识别？
- //学习webSocket  
- ==spring之后是梳理技术栈  kafka源码  设计模式  容器tomcat等；==
- hutools的功能好好过一下 
  - 作为一个字典类型的工具类，完整地阅读价值不大且无趣，用到时再查好了；==常用的模块可以考虑过一遍==；
  - //https://www.javajike.com/book/hutool/
- 绩效中心的登录 权限管理+路由，可以结合前端的课程梳理  研究下；
- 金融科技的历史与未来； //==/看看外面人家的绩效系统；==
- ==(hot100)==
- ==可能仿照jdk实现反射的效率提升吗？==
- 想参与一个apache的开源项目，磨练一下代码技艺；
  多关注些新的技术；多琢磨下，总能关注到最前沿的技术就已经很牛了；
- 锁表原因如何排查？问题如何检查？

#### 核心编码思想

##### **业务-设计阶段核心:** // ==定制化的内容尽量放到末端，前端---controller---impl---dao;==

为了解耦，让这个项目简单干净，单独建立了一张表； 

数据口径分析的时候，草稿的格式要规范

定版本的时候，开发预留的时间，估计一下顺利的话需要的时间*2+1(留给前端 测试

以后投产的前一周还是要好好规划啊



##### ==代码编写阶段(解耦 封装 判空  )：==

不出bug的核心:不出问题的核心是参数校验（controller那边 service）；投产的代码要有开关意识！投产时要自己把握投产质量，代码是否抛异常 功能是否正常 运行时间多久？

 

测试一定从修改后的代码 局部测试开始（一个个方法逐层往上测试），不能心急！！

压测的时候会起三台服务器，要是代码的结果局部矛盾要注意，可能会是这个原因;

 

##### 代码编写细节小结（收藏）：

心得：

==//逻辑较为复杂的，就先做一版简单的，之后再慢慢优化==

//重复代码太多了，令人头大，想要精简代码，需要学会写反射调用！！！！

//以后代码审查前先提交一版

- //以后调用别人接口尽量打印点关键数据，好定位问题是谁那边的；

 

//代码的质量尽量自己把握，测试到什么程度  机房的验证到什么程度； Sql的性能要到什么程度。

//日志写详细点，什么代码开始，什么代码结束，开关是否打开关闭；所有的代码都应该被try catch包围，之后出问题了找日志方便;

写代码尽量符合阿里巴巴和sonar的规范（如不要有魔法值 改代码的规范的时候替换很好用！！）； 

 sql语句一定 在验证测试过（符合UAT的sqlmode） 要确定能走索引，时间最好50ms以内，最好去机房验证过，sql语句的优化与索引继续学习！！！！！！不要用like  参数校验一定要做好！！！ 

//阿里巴巴和sonarLint不能有最高级别的报错!!

==以后每一个版本自己的脚本都单独整理一个脚本文件，最后的时候逐个添加并确认执行顺序（特别是部分任务由被人完成的情况）==

 

工具类封装：只要保证  拷贝出来的代码中没有那种对原来类特有的属性  的依赖，应该就没有问题！！



//一种写法出bug，不要死磕，换种写法试试，可能有意外收获

 

//Apollo参数的测试基本做完了，给个默认值apollo没有配置也是可以起的？？！！

(@Value注解的使用：主要用于读取配置文件中的属性，@Value(${server.port}:8080)https://blog.csdn.net/woheniccc/article/details/79804600 )； 

//测一下四个方式设置的优先级(application.properties中配置（rank2）；  apollo中配置(rank1)； @Value中设置默认值(rank3)； 初始化中给一个值(rank4) )！ 读取apollo配置需要配置VM option)

把自己mapper中所有的sql语句摘录出来，去生成环境测试下（时间最好50ms之内，超过1000W条需要分批）

//以后尽量后端写得差不多了再联系前端，如果有超版本代码要写怎么办呢？新代码可以新建一个文件，不动老的代码，之后替换下就可以了（直接commit或者迁移都可以）。



从库log.info添加类信息（以后留意吧，这次有info了也一样， qllfqzScheduled）

#####  在测试服务器上部署服务的流程小结(收藏)：

//api修改的话需要添加SNAPSHOT然后部署到私库；没有的话不用

//clean一下  install(skip单元测试 不用插件也是一样的， 插件有什么区别吗？)

su admin  //切换权限很重要，否则日志会读不到，然后apollo的更新也无法生效！

cd /home/admin/afrp

Ps -ef | grep java //管道的原理好好去学习下

Sh stop的脚本 //备份原来的jar包？？

Ps -ef | grep java //确定服务关闭

rm –rf ….jar

ll

rz //上传打包好的jar包？？？ 

Sh start的脚本

Tail -f ../logs/afrp....log //那些日志文件是什么？？

 

api这边的包添加-SNAPSHOT，才能部署到私服(deploy install –Dmaven.test.skip=true –f pom.xml) 

//部署细节：sql脚本一句一行； 插入前先删除，保证可以重复执行

 

##### 在批处理测试服务器上执行批处理程序：

batch的代码上传之后，要重命名为afrp-batch.jar，脚本里面写的是这个jar包。

 

投产：记得戴口罩

查app中轮询接口的所有sql，可以直接查进程号，然后添加到剪切板



#### svn

新一个版本开始工作前，确认上一个分支的所有修改都已经迁移过来了！！！！！！

测试代码全部注释后提交

最重要的就是要学会查看对代码的哪些部分做了修改

测试代码全部注释后commit，方便其他人测试

1.7.0的代码要手动迁移到1.7.1，因为创建1.7.1的时候，我的代码还没完善，需要查看两个分支的提交Log，对后面自己做的修改做补充

svn在merge的时候会把一个文件自己的修改和版本上的修改都加上

 

**以后需要代码对比的话多开一个i****dea****好了**	//好气啊，svn unversionedFiles中，broswer不见了？？？ 找不到解决方案！！！不过，我确信上周该提交的代码都提交了，所以问题不会很大。 我没记错的话，就是今天compare with之后，然后就不见了。		多修改了几个文件之后，compare with不见了，变成了nothing to show，并且broswer又恢复了。



#### maven

maven中parent标签的理解（可以直接为子项目添加依赖） 还有parent中depencyManagement标签的使用（子项目中有用到可以自己添加依赖，但是不需要指定版本）：

https://blog.csdn.net/qq_41254677/article/details/81011681



#### mysql

- mysql备份为.sql文件及通过备份文件还原数据：
  Mysqldump  --set-gtid-purged=OFF -u ampa -p$1  ampa  --tables base_user > ampabak.sql //备份
  Source  ampabak.sql ；//还原
  备份还原异常：@@GLOBAL.GTID_PURGED can only be set when @@GLOBAL.GTID_EXECUTED is empty
  https://blog.csdn.net/qq411139073/article/details/130235445
- 批量插入 (拼接sql一次性插入多条) 的效率可能高于单条插入：索引+多线程
- mysql 会把结果集中重复的记录删掉，而使用union  all ，mysql 会把所有的记录返回，且效率高于union 。
  https://www.cnblogs.com/alex0702/p/10767005.html
- ROW_NUMBER() OVER
  https://jingyan.baidu.com/article/9989c74604a644f648ecfef3.html
- 删除数据库中的重复数据；  
  https://blog.csdn.net/qq_37634156/article/details/125428654
  -- 方法二（推荐方法也容易理解）
  DELETE FROM t_user WHERE id NOT IN (
  	SELECT t.min_id FROM (
  		-- 过滤出重复多余的数据，比如，如果所有记录中存在1条记录是user_name=zhangsan的，那么就取出它；
      	-- 如果所有记录中存在多条记录是user_name=lisi的，那么只取其中1条，其他的不查询出来
  		SELECT MIN(id) AS min_id FROM t_user GROUP BY user_name
    ) t
  )
- 数据库死锁解决方法：
  https://blog.csdn.net/qq_34279303/article/details/115358560
  https://www.baidu.com/s?ie=utf-8&f=3&rsv_bp=1&tn=57095150_dg&wd=%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E6%AD%BB%E9%94%81%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95&oq=mysql%25E6%258B%25BC%25E6%258E%25A5%25E5%25AD%2597%25E7%25AC%25A6%25E4%25B8%25B2&rsv_pq=e8ba802600001077&rsv_t=73fcZk4IomNHolUwc%2BhsCmFwhha8k%2FDDz4R6jcfzTA8tw%2Fz9V23HFTyXjEb4VovG%2FJI&rqlang=cn&rsv_enter=1&rsv_dl=ts_0&rsv_sug3=30&rsv_sug1=17&rsv_sug7=100&rsv_sug2=0&rsv_btype=t&prefixsug=%25E6%2595%25B0%25E6%258D%25AE%25E5%25BA%2593%25E8%25A1%25A8%25E6%25AD%25BB%25E9%2594%2581&rsp=0&inputT=6302&rsv_sug4=7063
  SELECT * FROM information_schema.INNODB_TRX;
  kill 1200031; 
- 数据库和schema的区别？
  https://www.nuomiphp.com/article/7532.html
  https://www.zhangshilong.cn/work/231308.html
- Mysql   ROW_FORMAT：
  https://zhuanlan.zhihu.com/p/266060894
- datetime和timestamp的区别:
  https://blog.csdn.net/shenshengsu1990/article/details/124377806
- mysql允许脏读
  https://www.cnblogs.com/wangbiao10086/p/7387988.html  
- mysql表死锁：
  https://www.yzktw.com.cn/post/872159.html
  MySQL中出现lock wait timeout exceeded问题及解决
  https://www.jb51.net/article/259612.htm
- mysql查看空格
  https://www.yzktw.com.cn/post/627081.html
- navicat对比两个表是否相同；
  https://blog.csdn.net/lucky_she_niu/article/details/126953541
- Mysql update语法常规用法；mysql工具手册
  http://c.biancheng.net/view/2579.html
- mysql 文件转二进制流入mysql
  - 文件转Blob，入 sql脚本，可以load file[或者新增一个入库接口，postman发送请求入库]入blob，然后hex , unhex；或者直接复制为insert 语句；
    Mysql loadFile函数用法；https://www.dbs724.com/112055.html
    mysql load_file不能读取文件 要改secure_file_priv 
     https://blog.csdn.net/u012706348/article/details/116795179
  - mysql查看blob， cast(response as char),  HEX(response)
    查看---图像；
    https://www.uoften.com/article/226053.html
    Hex unhex可以十六进制转移文件，整半天之前的语法错误是分号报错了应该；
- 触发器
  - mysql触发器编写:
    http://c.biancheng.net/view/2600.html
- 日志清理
  - 查看日志位置，whereis my.ini/my.cnf;
    到日志目录下，登录mysql！！！！！
    查看正在使用的日志文件：show master status;
    purge binary logs to 'mysql-bin.000005'  //删除除mysql-bin.000005以外的日志文件
    https://www.8a.hk/index.php/news/content/5209.html

**mysql索引竟然是有优先级的，依据你建表的时候创建索引的顺序(****不知道会不会进一步依据索引的数据量优化？****)**

\1. 写sql的时候用？替换占位符倒是个好主意。

\2. sql的执行（运行时间首先看索引，其次看数据量，以后where里面不要用date_format这种函数 **,gourp by****的字段少一些**(其它参考面经精华版的MySQL优化)

 

 

\3. 使用group by的时候注意看情况添加 is not null的约束

all_group_by模式好像是要求，select中的函数必须要在group by中（普通字段没关系 count(1)这种也没关系?）

编写的sql要在测试和验证上都测试一下，最好去机房再测一下。

 

\4. mybatis中如果结果集合所有的字段为Null,该行数据会自动优化为Null(所以要判断返回的list中的元素是否为Null)

mybatis如果查询不到结果，会有List size为1，元素为Null??

 

mysql的大数使用的decimal，对应的jdbcType为Decimal，对应的java type为BigDecimal

https://blog.csdn.net/qq_38973672/article/details/89337175

 

mybatis指定jdbc type

https://www.cnblogs.com/yucongblog/p/7388648.html

 

Mybatis list入参：
https://blog.csdn.net/qq_27232885/article/details/100581042	

 

#### Dubbo

- dubbo接口返回对象有不超过8M的限制：
  理论上可以通过配置提高上限，但是不推荐通过dubbo传输文件；

#### 网络安全相关

- //xssFilter有什么用？
  https://blog.csdn.net/m0_46897923/article/details/107284031

#### TkMybatis

- org.apache.ibatis.binding.BindingException: Parameter 'company' not found. Available parameters are [1, 0, param1, param2] 报错解决
  https://blog.csdn.net/ITBigGod/article/details/82970621
  - idea编译的时候会自带-parameters参数，编译的时候保留变量名，应用在本地启动正常，批量执行也正常；但是打包是用pom打包，pom默认不带-parameters参数，故应用部署到服务器上的时候运行批量会报错；   elasticjob在执行定时任务的时候，会在备选的应用服务器中随机选一台，如果选中了本地的服务器就会正常执行批量，导致问题不容易发现；
    解决方案：就这个问题而言，pom文件添加编译参数-parameters即可；  本地尽量都不要连验证环境，有问题及时在验证环境发现；
  - 批量的问题复现:本地idea启动正常，服务器报错： org.apache.ibatis.binding.BindingException: Parameter 'company' not found. Available parameters are [1, 0, param1, param2]，最后定位到是IDEA默认配置的问题
    //可能是打板的Java版本问题，也可能是运行环境的java版本问题；
    本地我换了1.8.0_275还是没有问题，本地打包部署验证服务器还是报错，基本确定是运行环境的java版本问题；
    修改代码，加了@Param注解之后，问题解决；
    是不是jdk版本的问题，还要复现下问题才知道；（如果不是jar包的问题，可能是操作系统的问题；或者idea哪里做了默认的配置是Linux服务器没有的？）基本确定是idea的配置问题，高版本的idea编译时自带属性-parameter[大概是方便调试看变量值]，该配置的含义就是 告诉编译器，编译的时候记录下形参的真实名称，而pom编译时如果为设置-parameter，那么就会报错  org.apache.ibatis.binding.BindingException: Parameter 'company' not found. Available parameters are [1, 0, param1, param2]
    写mapper加上@Param是个好习惯
    参考：https://blog.csdn.net/yifangshikong/article/details/127106656
    https://blog.csdn.net/chirp_CQ/article/details/127094025
    https://blog.csdn.net/qq_32814555/article/details/105535834
- tkmybatis降序  setOrderByClause(“ user_type asc”); //注意这里的字段名是 数据库表不是 javaBean；
- tkMybatis 插入参数是对象T，差/删 参数是Example；
  deleteByExample传了obj的话可能会报下面的错：
  deleteByExample方法报错There is no getter for property named ‘oredCriteria‘ in 
  https://blog.csdn.net/weixin_41828144/article/details/114267356
- 【Java异常】使用通用Mapper ，报There is no getter for property named ‘distinct‘ in ‘class 错
  - selectByExample()方法传递的参数错误，应该传example类型，而不是实体类。
    注意selcetByExample(Example)和selectByPrimaryKey(javaBean对象)的入参不同
    https://blog.csdn.net/weixin_44299027/article/details/107530957

\5. tk mybatis自动生成mapper.java mapper.xml：在afrp-base目录的test/resource/generatorConfig.xml中，添加table标签，输入表的名称； Maven插件afrp-base模块的Plugins/mybatis-generator/generator  配置参数，然后执行即可。

//tkmybatis复杂and or条件：https://www.cnblogs.com/grey-wolf/p/8435723.html

//tkmybatis倒序，.orderBy("name").*desc*();   https://blog.csdn.net/fulong0406/article/details/121399260

//Tk.mybatis插入语句用法：

方法：int insert(T record);

说明：保存一个实体，null的属性也会保存，不会使用数据库默认值

方法：int insertSelective(T record);

说明：保存一个实体，null的属性不会保存，会使用数据库默认值

https://www.cnblogs.com/alimayun/p/12572350.html

tkMybatis  update:

https://blog.csdn.net/Seven71111/article/details/105114202/

tkMybatis  insert delete:

https://www.cnblogs.com/alimayun/p/12572350.html

 

mybatis 自动生成表带格式化日期注解

可以是可以，但是要改配置，有点麻烦的

https://www.cnblogs.com/wbl001/p/11789880.html

 

5.1  tkmybatis排序

tkmybatis排序：

 example.orderBy("createTime")

​    /*.desc()*/

​     .orderBy("id").desc();

https://www.codeleading.com/article/16904496186/

 

5.2 Replace_into用法

Replace_into用法

https://www.cnblogs.com/c-961900940/p/6197878.html

创建唯一索引

https://blog.csdn.net/qq_31868149/article/details/91960336

//试验下：如果同时有主键索引和唯一索引呢？ 有一个相同便会替换！！

 

5.3 mybatis 返回Integer、Double、String等类型的数据

mybatis 返回Integer、Double、String等类型的数据

https://blog.csdn.net/fenfenguai/article/details/79220704

 

5.4

count中使用表达式或者case when；

https://blog.csdn.net/weixin_39673471/article/details/113129184

 

5.5

修改字段备注

https://www.cnblogs.com/MagicAsa/p/11057863.html

 

\6. 编写mysql存储过程相关

编写sql脚本，编写函数不添加DELIMITER $$会报错？？

https://blog.csdn.net/immenselee/article/details/78836104

sql脚本编写：

https://www.cnblogs.com/qianjinyan/p/13755809.html

https://www.cnblogs.com/hhhshct/p/14414480.html

 

 

mysql存储过程使用if

https://blog.csdn.net/yali_aini/article/details/85701775

mysql存储过程  插入日期 递增

https://blog.csdn.net/weixin_30924087/article/details/95127658

mysql存储过程  数据类型

https://www.cnblogs.com/YuyuanNo1/p/7778061.html

 

命令行执行  存储过程，delimiter $$的修改和改回来需要手动执行！！存储过程中需要删除；

https://www.cnblogs.com/qianlicao/p/10867838.html

 

delimiter的用法  原理：

delimiter是mysql分隔符，在mysql客户端中分隔符默认是分号(；)。

如果一次输入的语句较多，并且语句中间有分号，这时需要新指定一个特殊的分隔符。

https://blog.csdn.net/weixin_36213756/article/details/113262207

https://blog.csdn.net/weixin_39715513/article/details/113613899

 

 

\6. mysql添加列：

https://www.cnblogs.com/codecat/p/12028845.html

mysql删除列：

https://www.cnblogs.com/ningqing2015/articles/9799727.html

myslq获取字符串长度：

length:  是计算字段的长度一个汉字是算三个字符,一个数字或字母算一个字符？？？

https://www.imooc.com/article/43280

mysql连接字符串：

CONCAT(string1,string2,…)  说明 : string1,string2代表字符串,concat函数在连接字符串的时候，只要其中一个是NULL,那么将返回NULL;

https://blog.csdn.net/qq_35275233/article/details/86610200  ;

 

//mysql生成随机字符串：select substring(rand(),3,6) https://blog.csdn.net/qq_38234015/article/details/108979493

mysql中截取指定字符前后的字符串

SUBSTRING_INDEX(str,'"',2)取出从左往右第二个引号左边的字符串str

https://www.cnblogs.com/leon0/p/10790443.html

varchar(N)表示能存N个字符，能存N个中文或英文

 

7.（很神奇，光联合索引date_left5还是非常慢！！！ 试试多添加一个left5索引，还是慢！ 改成多添加一个date的索引？变快了！！！！！  很神奇，当条件有两个时，单单一个条件很慢，联合索引也很慢，但是 单条件索引+联合索引 就很快！！！ 为什么啊？？？？？？）；

 

8.mysql备份

mysql备份表

https://www.cnblogs.com/weifeng1463/p/12986832.html?ivk_sa=1024320u

 

\9. mysql格式转换

Mysql  dateTime转字符串：

SELECT DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s');

https://www.cnblogs.com/zluckiy/p/10295387.html

 

\10. mysql触发器相关

触发器的思路应该是可以做的，但是需要安装软件mysql_udf_http，应该会很麻烦。而且要理解在公司的网络中ip的设置，估计有点麻烦。

解决思路：

https://blog.csdn.net/qq_35644307/article/details/109739647

mysql-udf-http安装：

https://blog.csdn.net/lcy132100/article/details/51428144/

New、old的使用：

https://www.cnblogs.com/joyco773/p/5787088.html



11.mysql主从同步相关  //跳过transaction;  bin_log定位、查看；

==Mysql 获取binlog位置以及查看binlog日志内容==
https://blog.csdn.net/weixin_42076409/article/details/115705845



如何跳过transaction???
不小心在slave上插了一条数据；然后同步停止，slave_sql_running变为停止状态；
一般可以通过设置slave_skip_count=n跳过；
https://www.cnblogs.com/zwjphp/p/14902869.html
https://blog.csdn.net/weixin_42076409/article/details/115705845
但是我们这里会报错：
ERROR 1858 (HY000): sql_slave_skip_counter can not be set when the server is running with @@GLOBAL.GTID_MODE = ON.
所以这里我们选择用空的事务跳过；
https://blog.csdn.net/fujiakai/article/details/82225691
新的问题就是如果查看bin_log，具体那个Bin_log可以通过show slave status\G；命令查看relay_log_file???  exec_master_log_pos
Bin_log的存储位置可以查看/etc/my.cnf中data_dir的属性值；//或者find / -name ....;
Bin_log是二进制文件，直接查看会乱码（用cat、vim也一样），需要用mysqlbinlog工具查看：
//https://blog.csdn.net/weixin_42298973/article/details/113909591

Mysqlbinglog --stop-position=1500 -v ‘/var/lib/mysql/mysqld-relay-bin.000005’  //可以参考exec_master_log_pos; 主要是找到问题sql前面的那条set GTID_NEXT=’........’ 信息；

https://blog.csdn.net/weixin_34125509/article/details/113400907
stop slave;
set GTID_NEXT='9760cb92-693e-11e8-85bf-000c29b55cf0:11';
#开启一个空事务
begin;commit;
SET GTID_NEXT='AUTOMATIC';
start slave ;



find / -name 'auto.cnf'
mysql查看用户权限的方法：通过执行【show grants for 用户名】语句即可查看用户权限，如【show grants for root;】。

Slave failed to initialize relay log info structure from the repository；
Reset slave;//start slave; stop slave;
https://blog.csdn.net/weixin_37998647/article/details/79950133

Change master的时候报错：
Fatal error: The slave I/O thread stops because master and slave have equal MySQL server
==因为克隆的主服务器，导致主从mysql uuid相同， Slave_IO无法启动； 确认下server id 和uuid都不同==//之前我设置的serverId超过10位，没有生效，以后注意
https://blog.csdn.net/co1590/article/details/120190659
https://www.cnblogs.com/stronger-xsw/p/12787546.html



12.mysql  replace_into相关

//replace into+ 唯一索引；两个唯一索引（主键也是唯一索引）时，只要有一个相同就会先删再增，可以考虑只保留一个唯一索引，或者插入的时候少插入一个唯一索引字段（但是该字段必须自增，不能是有默认值的）



13.mysql  data truncated for colunm 插入数据库的时候，插入数据和数据库类型不匹配;

[https://www.cnblogs.com/i6010/articles/6555257.html](https://www.cnblogs.com/i6010/articles/6555257.html)



14.从数据库同步停止，但是两个running为Yes；exec暂停且小于read；show processlist发现是某条sql卡死了，可以kill这条sql并通过；
Mysql杀死一条执行中的sql；

show processlist;

kill id;

https://wenku.baidu.com/view/078dd337cf7931b765ce0508763231126fdb774b.html



15.bug解决，无法找到数据源slave1的问题；-Denv写错了；//断点调试，jar报也行；

16.//定时服务的方法上配置从库竟然不生效？？？[不知是log.info的原因；还是注解位置的问题；还是说 ==一定要@Autowired注入才能使注解生效[也就是科技部所谓的要通过service形式调用]==



#### PSQL----HAWQ语法相关

- 其它数据库
  - hive 的 lateral view用法以及注意事项
    https://blog.csdn.net/weixin_41579433/article/details/124799660
    常配合EXPLODE使用
    https://blog.csdn.net/zhaomengszu/article/details/124085194
- Max_pt表示取字典序最大的分区；
  https://wenku.baidu.com/view/14197a0c0366f5335a8102d276a20029bd6463b5.html
  @@{yyyyMMdd}表示取当前日期；
  https://help.aliyun.com/document_detail/42709.html
- psql插入数据：values，字符串只能用单引号’’；https://www.runoob.com/postgresql/postgresql-insert-into.html

- No partition for partitioning key：插入数据要为对应的etl_date单独建立一个分区，用尹总发送的命令( select dws.f_add_day_partition(‘DWD’, ‘DWD_...RECORD’,’20220325’, ‘R’) )；
- Psql、hawq创建临时表；
  https://www.5axxw.com/questions/content/c4lorq
  create temp table data (id int, date date, value1 int, value2 bigint, value3 int);
  insert into data
    Values

 

#### redis的使用

\0. 如何保持数据库和缓存的一致性

https://blog.csdn.net/sinat_16712671/article/details/76130829

 

\1. json包一层就可以了，如out中包含两个hashmap，直接JSON.toJsonString(out)即可，无需再hashmap再包一层；

\2. 通常需要添加过期时间;

\3. redis服务器上命令行查看是肯定带有/，这是因为存入的时候序列化？；只要保证RedisTemplate get出来的没有\就可以了，即保证set使用的RedisTemplate的序列化器和get使用的RedisTemplate的序列化器都是FastJson那个序列化器 （StringRedisTemplate的序列化器则默认）

\4. redis删除key

redisTemplate delete并不能直接使用通配符，需要先查出key set，再用keyset去删除

Set keys =redisTemplate.keys("指定字符"+"*");
redisTemplate.delete(keys);

4.9 redis-cli常用命令

  GET KEY_NAME		https://www.redis.net.cn/order/3545.html

EXPIRE key "seconds"  

PEXPIRE key "milliseconds"   

https://www.cnblogs.com/sunshine-long/p/12706868.html

 

5.解决redis-cli command not found问题: 先进cli,，redis-cli -h IP -p port

\6. redis轮询的一些tips: 考虑到集群并发 轮询，redis中不适合存标志变量，不过可以考虑用一个map，包标志变量和变量一起存，来);  redis相关的代码，涉及到读写的，只能部署到测试服务器上再测试了 不然本地冲突，无语。（或者就只能在验证玩了） 或者本地读取本地的配置，设置短一些，然后把测试上设置长一些;  

\7. IDEA里面往redis存数据，有些再命令行查不到！！！！但是在IDEA能查，伟健说可能是序列化方式不一样！！！  所以IDEA插入尽量用IDEA查！！！！

\8. redis使用Map<String, List<DToSzfk>>这种数据结构时，用两层JSON包装！！！！！！！（用两层的话可以还原数据结构，如果不需要还原数据结构，可以只用一层！）

类似的，Map内要还原的不是List<DToSzfk>而是DToSzfk也是一样的。

\9. StringRedisTemplate常用方法：

stringRedisTemplate.opsForValue().get("test")//根据key获取缓存中的val

stringRedisTemplate.opsForValue().set("test", "100",60*10,TimeUnit.SECONDS);//向redis里存入数据和设置缓存时间

stringRedisTemplate.boundValueOps("test").increment(1);//val +1

https://www.idarks.com/article/79

//测试下自己用increment方法，为Null的时候是否能自己添加该主键; 可以；

 

\10. 数据刷入redis，用的是固定的key，注意考虑超时不能处理的数据，否则redis容易爆

 

#### Nginx

- Nginx配置： open() “xxx/logs/error.log“ failed (2: No such file or direc    可能是启动路径不对；
  https://blog.csdn.net/Supporint/article/details/118212461 
- Proxy_pass的深刻理解——nginx转nginx转服务器要如何实现？
  Nginx1监听域名+443端口，proxy_pass配置Nginx2+443；nginx2监听域名+443端口,proxy_pass配置服务器。
  正常来说，nginx2应该监听localHost+443，然后proxy_pass配置服务器才对；实验证明了，nginx2监听域名+443的时候，默认会同时监听该端口，即localhost+443（例如，自己配置监听lrh-verify.czbank.com:6000，氛围203.1.128.43:6000也确实被监听了，甚至连证书消息都提示出来了）
- nginx支持的最大并大量：发送一个请求需要占用两个或者四个worker，静态资源为两个（一来一回），动态资源（服务器）为四个（nginx还要去访问tomcat等服务器，拿到信息后返回，占用两个； 
  普通的静态访问 最大并发数是： worker_connections * worker_processes / 2；
  而如果是 HTTP 作为反向代理来说，最大并发数量应该是 worker_connections * worker_processes / 4； 
  https://blog.csdn.net/qq_51729037/article/details/129431954
- 只要网络通了，nginx监听了80端口https，如果收到http请求就会报http to https失败的问题；  在虚拟ip+端口 telnet能通的前提下，nginx的proxy_pass是可以配置为虚拟Ip的。  
- 虚拟Ip+端口也是可以telnt通的，但是在行内可能存在虚拟Ip只对外网开放的情况，如企业微信dmz网关233（实地址231）、移动办公dmz网关16（实地址17 18）；

####  java基础

- Java中字符串中子串的查找共有四种方法(indexof()):
https://blog.csdn.net/u010227042/article/details/118221413
  
- Split，只在前n-1次遇到x字符的时候进行分割：
split(regex, 0);
  
- java生成不重复的id；host[mac地址可能更好]+时间戳+睡1毫秒；
https://blog.csdn.net/gyxx1998/article/details/124712779
  
  https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&tn=57095150_dg&wd=currenttimemillis%E6%96%B9%E6%B3%95&oq=java%25E8%258E%25B7%25E5%258F%2596%25E6%259C%25BA%25E5%2599%25A8%25E7%259A%2584ip&rsv_pq=968495ce005b0b69&rsv_t=0c5cUflHvzzHN2mjhiJ67mi93Wv0UIoqDYyQn%2F2uVJ0mrCeRAYqrPbxbVgE%2F5qHvA3w&rqlang=cn&rsv_enter=1&rsv_dl=tb&rsv_btype=t&inputT=5308&rsv_sug3=76&rsv_sug1=54&rsv_sug7=100&sug=currenttimemillis%25E6%2596%25B9%25E6%25B3%2595&rsv_n=1&bs=java%E8%8E%B7%E5%8F%96%E6%9C%BA%E5%99%A8%E7%9A%84ip
  
- 时间轮算法；
这个示例代码简洁：
  https://www.w3cschool.cn/article/35823380.html
  这个原理详细：
  https://www.sohu.com/a/503693703_121124376
  
- 正则表达式中|需要转义，普通字符串则不需要：
https://zhidao.baidu.com/question/34776610.html
  
- 读取txt文件：
文件小，无中文可以用Scanner;  https://blog.csdn.net/weixin_32188111/article/details/114080667
  文件大，有中文可以用BufferedRader; https://www.jb51.net/article/231553.htm
  
- 分页工具类相关

  - PageHelper，为什么普通的list使用doSelectPage必须要套层分发到外壳？看来结果是被当作方法来用的 而不是返回值；
  
    PageHelper原理：里面的函数不是sql，用不了doSelectPage；
    https://blog.csdn.net/weixin_46649054/article/details/124152808
    对list进行分页：
    https://www.cnblogs.com/LilLazy/p/16032553.html
  
  - PageInfo用的是默认的序列化方法；
    https://blog.csdn.net/BlackCutter/article/details/46799481
  
  - offsetPage返回值是有总数的，但是序列化不会展示；PageInfo序列化会展示total，page不会，Page是怎么做到的？？ 应该是因为Page继承了ArrayList，同时也继承了ArrayList的序列化方法 readObject，包括元素保存在ArrayList的elementData中？
    https://www.likecs.com/show-712673.html
    https://blog.csdn.net/CommunicationJava/article/details/115874654
  
- 获取上一个周六；TemporalAdjuster 
   now.with(TemporalAdjusters.firstDayOfMonth()).toString();
  https://blog.csdn.net/weixin_49114503/article/details/121676567
  
- bigDecimal乘法三种方式：
https://blog.csdn.net/qaz5209103/article/details/111919609
  
- 正则表达式需要转义的字符；
https://blog.csdn.net/qq_42449963/article/details/107279697 
  
- 读到的txt中文是乱码？？
https://code84.com/686316.html 
  
- Java中获取当前方法信息：https://www.itshiye.com/05/11832.html
https://www.python100.com/html/54304.html
  
- postman使用 

  - Postman上传、下载文件：
    https://blog.csdn.net/weixin_52003076/article/details/125207276
  - java 发送http post请求 参数为list或者 map: ?fileIdList=a,b;
  - postman添加sessionID，https://blog.csdn.net/graceljh/article/details/100522685
    Chrome查找cookie,https://www.cnblogs.com/qy-blogs/p/10900151.html

- 异常处理

  - log.warn("msg", exception)
    
  - 合理的异常处理策略：自定义一个类extends RuntimeException； 全局异常处理器中对自定义的异常进行处理[类@ControllerAdvice + 方法@ExceptionHandler]；[定制化一些的话 ，可以在自定义的类中  定义单个类的统一异常处理器]
    ==对于代码逻辑的一些问题，可以直接throw RestException；对于三方类必须处理的异常，可以先打印，然后转换为RestException抛出；==

  - java抛出异常后面的代码是否能执行   throw Exception之后不会执行；try catch之后的会正常执行；
    https://www.likecs.com/show-204463153.html

  - 异常处理策略：
    建议在最外层处理；
    8、【强制】 捕获异常与抛异常，必须是完全匹配，或者捕获异常是抛异常的父类。
    说明： 如果预期对方抛的是绣球，实际接到的是铅球，就会产生意外情况。
    https://zhuanlan.zhihu.com/p/67234342

  - **e.printStackTrace() 会导致锁死？**

    [**https://blog.csdn.net/kzadmxz/article/details/89914896**](https://blog.csdn.net/kzadmxz/article/details/89914896)

    **java异常结构图**

    [**https://www.cnblogs.com/zeroingToOne/p/9534233.html**](https://www.cnblogs.com/zeroingToOne/p/9534233.html)

  - 异常信息没有正常返回，我一开始以为是没getMessage取到明细，后来发现可能是忘记添加@Response注解了；再后来猜测是：返回值不是200直接被postMan拦截了；最后发现，是catch捕获异常之后，又抛了事务回滚异常，这个异常没被捕获，而且为了能正常回滚，不好对这个异常进行捕获，还有一种思路就是手动捕获回滚异常，手动回滚并返回异常信息，下个版本再研究吧；没思路的时候多看看日志！！！！  

  - 现在的问题是：异常处理之后，还有事务回滚的异常，这种情况下我改如何把之前异常的错误信息 传递到事务这边并返回？除非找个中间件暂存异常信息；
    新的问题：捕获不到这个回滚异常，是不是要把 回滚注解添加到方法上而不是类上 加了还是捕获不到； 被全局异常处理器 baseExceptionHandlerAdvice  @ExceptionHandler(Exception.class)捕获了 现在暂时把异常信息放到全局异常处理器打印，也算一个解决方案，但是不适合高并发的场景；

    spring事务手动回滚：
    TransactionAspectSupport.currentTransactionStatus().setRollbackOnly();
    标准答案：情况三：如果自己需要捕获异常又要返回错误时，可以参考以下做法；自测下是否确实能回滚；是的；
    https://blog.csdn.net/wjxbj/article/details/84793080

    全局异常处理方式：基础的就是@ControllerAdvice+@ExceptionHandler；
    https://blog.csdn.net/JokerLJG/article/details/123297513
    
    - 如果当前类被标注为@Transactional，且子方法设置了setRollBackOnly，则返回前还会抛一次异常，故不建议设置controller为@Transactional

- excel

  - excel查找通配符：“*”:代表任何的字符；“?”:代表任何的单个字符；
    “~”:代表解除字符的通配性
    
  - 读入excel文件 xls，xlsx；
    https://www.cnblogs.com/caiba/p/15535125.html
    
  - 导出excel报错 http media Type Not Acceptable Exception could not find acceptable representation, 最后修改了返回类型为void，问题解决
    https://blog.csdn.net/baidu_36720706/article/details/105092673
    https://blog.csdn.net/zwhfyy/article/details/70598370?utm_source=blogxgwz5
    
  - workbook用完要及时关闭；EasyExcel.read结束会吧inputStream设置为null?但是getInputStream()就不会，只有一种解释，getInputStream()是深拷贝，验证过是的；
    
  - hades升级导致  一个excel导出接口抛异常
    
  - //逐步调试看看，是那一步报错了？？ 猜测是测试环境更新了hutools版本导致
      和poi不匹配了；为什么第一版的时候没有问题？(验证环境ok说明上个版本也没有问题；pom变化只有swagger添加版本号)  和上个版本的变化只有swagger添加了版本号，但是在poi之后，在hutools之前；也不排除maven仓库更新的情况；//先试试更新poi版本是否能解决问题再看，贸然改版本确实不大好；
    
      有依赖又没有指定版本，应该会最短路径原则确定版本？想知道版本号 可以看父pom有没有对应依赖；看来下hades.pom中有hutools的依赖，但是降低hutool版本倒hades的1.2.3对应的Hutools版本不能解决问题？？？这是为什么？？[可能还有其它地方用到了hutools？或者1.2.3实际的版本并不是5.3.10？   5.3.10   5.7.13 ][hades无法完全回退，目前只能升级poi]  升级Poi版本部分代码会编译报错；(对应代码略作调整，两处异常无所谓，两个背景设置试过了，调整过后是有效的)
      设置背景颜色 4.1.2 https://blog.csdn.net/oracle8090/article/details/106260459
      颜色对照表 https://blog.csdn.net/ling_du/article/details/66475708
      问题解决方案： https://gitee.com/dromara/hutool/issues/I42UYS
    //取消poi的版本指定试试？默认3.17
    
  - EasyExcelListener：如果第二行读到空单元格，则第一行就只读到空单元格的前一列[合并单元格似乎可以例外]；
    
  - excelWriter.write只导出部分字段
    https://blog.csdn.net/ZLK1142/article/details/106126559/

    InputStream与MultipartFile互转
    getInputStream()方法
    https://blog.csdn.net/LCPMVP/article/details/126419581
    https://blog.csdn.net/weixin_50726818/article/details/127052304
    cannot get a string value from a numeric cell
    https://blog.csdn.net/qq_35893120/article/details/80395080

  - excel单元格置灰；
    https://blog.csdn.net/qxy15997826736/article/details/107701473
    不能直接getCellStyle，一改会直接改整个表 应该是整个表共用一个cellStyle的原因；

  - excel显示隐藏对象、删除隐藏对象；
    https://jingyan.baidu.com/article/e3c78d648d3c2c7d4c85f5ad.html
    https://www.wps.cn/learning/room/d/329987

  - 单元测试类输出下；
    SAX读取excel文件：
    POI读取Excel有两种模式，一种是用户模式，一种是SAX事件驱动模式，将xlsx格式的文档转换成CSV格式后进行读取。用户模式API接口丰富，使用POI的API可以很容易读取Excel，但用户模式消耗的内存很大，当遇到很大sheet、大数据网格，假空行、公式等问题时，很容易导致内存溢出。POI官方推荐解决内存溢出的方式使用CVS格式解析，即SAX事件驱动模式。
    https://zhuanlan.zhihu.com/p/597186664
    https://www.jianshu.com/p/ef7ae99cb3f7
    https://blog.csdn.net/qq_30908729/article/details/92839667

  - Workbook转MultipartFile
    https://blog.csdn.net/qq_38974638/article/details/119844636
    poi,easy excel 导出删除指定列
    https://blog.csdn.net/xiaosemei/article/details/122324233

  - 绩效中心目前的excel导出有列数限制，256 //HssfWork类替换为XssfWork类即可
    https://blog.csdn.net/yanyundi/article/details/110521826

  - excel常用单元格格式设置
    文本  https://www.codenong.com/36018660/
    https://blog.csdn.net/SunnerChen/article/details/123003946  

  - excel合并单元格：
    addMergedRegion
    https://vimsky.com/examples/detail/java-method-org.apache.poi.ss.usermodel.Sheet.addMergedRegion.html
    writer.merge
    https://blog.csdn.net/qq_37050372/article/details/107643624/

- 工具类

  - list下标遍历的时候可以删除，但是要记得i--，否则会少遍历下一个数据；
  - java 中枚举类enum的values()方法的详解
    https://blog.csdn.net/WuHey/article/details/120529717
  - CollUtil.isNotEmpth(value); 
    list居然有contains()!!!!!!!!!!!   
  - java字符串拼接，Stirng.join(“-”, list);
    Chrome F12显示区域变窄，应该是误点了调试工具
    https://blog.csdn.net/zuanshifly/article/details/102681003
  - indexOf用法
    https://blog.csdn.net/weixin_42355240/article/details/120147798
  - Java+scanner如何向文本文档中写入多行数据？
    https://zhidao.baidu.com/question/498785912034332612.html 
  - scanner用法：
    https://www.cnblogs.com/javalove2022/p/16771634.html
  - ROUND各种取值说明：https://blog.csdn.net/weixin_44804963/article/details/119886202

- 反射

  - java反射调用构造函数：
    https://blog.csdn.net/weixin_67497686/article/details/129344982 

- 正则表达式

  - 正则表达式语法
    https://www.runoob.com/regexp/regexp-syntax.html
    https://www.cnblogs.com/yuxiaole/p/9380104.html
  - 正则，不含中文
    [`^` 中文范围]*
    https://it.cha138.com/nginx/show-317173.html

\1. hashMap的使用，在用get之前要判断下key是否存在！！！

对map排序；

https://blog.csdn.net/p812438109/article/details/105758128

linkedHashMap遍历：

https://blog.csdn.net/qq_40351478/article/details/87949852

//Null异常处理的时候，对==null的情况就行处理，因为后面可能会用到多次；

\2. return之后还会执行finally吗？

大意就是如果在try中return的情况下，先把try中将要return的值先存到一个本地变量中，即本例中的x=2将会被保存下来。接下来去执行finally语句，最后返回的是存在本地变量中的值。

Notes:还有一点要注意的，如果你在finally里也用了return语句，比如return ++x。那么程序返回值会是3。因为规范规定了，当try和finally里都有return时，会忽略try的return，而使用finally的return。

https://www.cnblogs.com/LoveBell/p/12007181.html

 

\3. 保险点，Integer转String多加1个判空？还有double，全部用data+””的方式转换即可

 

\4. 日期

- //判断当天是否为月末，calendar的roll，其实设置date为-1比相等即可；
  roll和add区别：
  https://blog.csdn.net/u013584303/article/details/81539923
- Calendar，月末可以set DATE为0；；

dateFormat格式说明：

https://blog.csdn.net/a1439775520/article/details/98444189

![img](实用_代码编写的细节-photos/wpsBD43.tmp.jpg) 

日期比较大小：

https://blog.csdn.net/lz199719/article/details/81261336

 

\5. 异常处理：

Java异常是否可以不处理？第一，不处理会交给jvm默认的处理函数，会给用户不好的体验；第二，不处理可能导致程序直接退出，且  没有善后的相关代码；所以 一般还是得到处理的。

 

https://www.cnblogs.com/ganbing/p/6277108.html

所以异常被Java运行时系统的默认处理程序捕获。任何不是被你程序捕获的异常最终都会被该默认处理程序处理。默认处理程序显示一个描述异常的字符串，打印异常发生处的堆栈轨迹并且终止程序。

 

https://zhuanlan.zhihu.com/p/161500509

RuntimeException和 CheckedException异同; 这类异常通常是由编程错误导致的，所以在编写程序时，并不要求必须使用异常处理机制来处理这类异常,而是经常需要通过增加“逻辑处理来避免这些异常”。

这类异常通常是由编程错误导致的，所以在编写程序时，并不要求必须使用异常处理机制来处理这类异常,而是经常需要通过增加“逻辑处理来避免这些异常”。

 

 

\6. Java stream

Java stream依据多个属性分组：

https://www.cnblogs.com/maohuidong/p/14073911.html

求和 平均值等：

https://blog.csdn.net/q649381130/article/details/84338152

 

Java streaming分组后排序，

第一种写法，没理解错的话第二个参数指定了返回的大的类型（LinkedHashMap）,第三个参数指定了Map的第二个泛型，List

https://www.cnblogs.com/dijia478/p/15371346.html

第二种写法

https://www.jianshu.com/p/ecf21cade1a6

 

 

\7. Arrays.sort()  Collections.sort()源码阅读

Collections.sort()源码解析，里面调用的还是Arrays.sort(); 用户可以指定老大MergeSort，也可以使用新的Timsort; 对于小于32的数组，直接使用二分插入排序（插入的时候使用二分法找到插入的位置），否则就先进行分段排序(段内还是二分插入排序)，然后合并;  https://blog.csdn.net/chang384915878/article/details/79523929

//对于小数组的排序使用插入排序，大数组的时候使用快排，归并排序之类的。**这个小大又是为什么呢****？**

![img](实用_代码编写的细节-photos/wpsBD44.tmp.jpg) 

 

\8. StringUtils常用方法

StringUtils.isNullOrWhitespaceOnly;

BeanUtils.copyProperties  : https://blog.csdn.net/dfshsdr/article/details/90513676

 

\9. BeanUtils.copyProperties(A,B)

BeanUtils.copyProperties(A,B)，自己测试下了，A是赋值者，B是被赋值者，一般要求A的元素比B多？

hutool的beanUtils用法：https://blog.csdn.net/weixin_49390750/article/details/126099978

BeanUtil.copyProperties(sourceObject, targetObject,CopyOptions.create().setIgnoreNullValue(true).setIgnoreError(true));

ignoreNullValue 是否忽略空值，当源对象的值为null时，true: 忽略而不注入此值，false: 注入null
ignoreProperties 忽略的属性列表，设置一个属性列表，不拷贝这些属性值
ignoreError 是否忽略字段注入错误

- Apache BeanUtils性能较差，可以使用 Spring BeanUtils 或者 Cglib BeanCopier 来代替。
  https://www.jianshu.com/p/2ca157963698
- springboot中使用BeanUtils只拷贝对象中属性值不为null的属性
  https://blog.csdn.net/qq_36573702/article/details/108084207

####  泛型和反射

函数封装让业务代码少一个量级别；泛型则让函数的数量少一个量级；反射让类的数量少一个量级；

 

\1. 反射获取：https://www.jb51.net/article/162529.htm

Student stu = new Student();

Class classobj1 = stu.getClass();

Class classobj2 = Class.forName("fanshe.Student");

Class classobj3 = Student.class;

***\*泛型方法定义: https://blog.csdn.net/chengqiuming/article/details/94767664\****

 

\2. instance结合泛型 //会报错

https://www.manongdao.com/article-1357836.html

#### 程序设计

- controller==返回结果==是个T还是蛮有意思的（返回对象就统一了）；
  一个页面一个DTO类也就够了；分页的写法也蛮有趣的，可以参考下[一个基础分页参数类，然后所有的DTO类继承一下分页参数类]；

#### 多线程

- ScheduledExecutorService用法：
  https://blog.csdn.net/cyan20115/article/details/106548916

  newSingleThreadScheduledExecutor和newScheduledThreadPool的区别“
  https://blog.csdn.net/qq_44491709/article/details/119756525
  newSingleThreadScheduledExecutor的第二次执行时间，等于第一次开始执行的时间，加上执行线程所耗费的时间，再加上延迟时间，即等于第二次执行的时间；
  Executors.newSingleThreadScheduledExecutor() , scheduleWithFixedDelay用法：
  https://blog.csdn.net/weixin_44018338/article/details/102504576

#### spring框架相关

- spring框架配置单元测试相关错误      
  
  - Spring Test版本不匹配导致找不到类；
    mapeer找不到
    是启动类的注解的问题，使用了springBoot代替enableAutoCOnfig，然后把原来代码的启动类注解全部注释调之后，成功运行了单元测试。 明天再做做减法，把没用的配置类去掉，名字改下testApplication好了；
    
    Cannot resolve symbol
    注意先配置jdk，再配置maven
    https://www.jb51.net/program/305344msw.htm
  
- token cookie原理和区别？  shiro的原理和使用方法？
  
  - token是request 的request.request.coyoteRequest.headers里面的属性  cookie和token什么不同？[cookie是http协议的概念，通常sessionId会保存在cookie头中；token是session的一种升级，是JWT的概念，常保存在Authorizatioin头中]绩效中心的身份校验比较原始，还是用session？ 我们这个防重复的场景使用cookie应该也是可以的[同一用户登录多次cookie也是相同，但是不同用户登录时不同]   前端token的内容可以复习下  研究下绩效中心的session生成机制[可能要研究下SecurityUtils用法]+请求拦截器
  
    登录拦截器的搭建：自定义登录拦截器JwtInterceptor（实现HandlerInterceptor）    自定义WebSocketConfig（注入一个ServerEndPointExporter）    InterceptorConfig(实现WebMvcConfigure)中添加拦截器JwtInterceptor   
    //项目中的LogInInterceport继承了HadlerInterceptorAdapter；有一件事情可以确定项目没有自定义登录拦截器，使用了shiro自带的而且指定了session超时的url； 
    为什么没有拦截器？（shiro的过滤器可以自己重写）
    shiro是选择使用filter过滤器来进行拦截的，因为Shiro不依赖Spring容器，所以当没有springmvc时意味着不能用拦截器，但过滤器则不同，只要是web项目都可以使
    https://blog.csdn.net/m0_67401382/article/details/124344640
    shiro使用基本示例：
    https://blog.csdn.net/qq_36700462/article/details/111992778
    正常使用shiro是需要在shiro.ini配置用户名、密码的，但是绩效中心的系统没有配置，原因大概是统一认证重写了token类（里面有自定义的 密文的key?）login(token) 【】；用了统一认证系统的用户名、密码进行校验；
    统一认证登录用的token是AuthSsocToken，自定义的doGetAuthenticationInfo， 调用了统一认证的方法ssoService.getSsoUserId，估计用了统一认证系统的用户名、密码 或自己的格式要求进行了校验；
    普通的login是不是没有用？没有用；
    logintTest用的token类是AuthTestToken，自定义的doGetAuthenticationInfo直接放过；
    //loginsController，大数据营销平台拷贝来的代码， 没有在用；
  
    //所以自己编写登录模块：1.编写controller接口供统一认证调用；2.自己自定义类继承AuthorizingRealm并重写doGetAuthenticationInfo方法
    统一认证的登录最后到了RealmService.java中的doGetAuthenticationInfo; 调用了统一认证的方法ssoService.getSsoUserId 
  
    自定义token类：
    https://blog.51cto.com/u_15696939/5415378 (新版1.7似乎不用自己重写supports)
    https://blog.csdn.net/qq_43842093/article/details/121889892
  
- 日志打印相关：//要想打印batch的日志，loggers里面，注释掉console那行即可(调整pom.xml中相关的配置)；dide批量的日志级别应该是debug
  
- java @Async 单元测试报错
  https://blog.csdn.net/ywh15387127537/article/details/122201810
  
- xml中小于等于写法？？？？？

- @PostConstruct用法
  https://blog.csdn.net/sunayn/article/details/92840439
  
- wsdl文件转换为java源码:
  Wsimport -encoding utf-8 -keep -p com.czb -d D:\\  http....?wsdl
  https://blog.csdn.net/Yinyaowei/article/details/105932185
  
- wsdl解析出的java文件apollo配置化 + @Autowired的变量抛空指针异常：
  @Autowired会在第一时间调无参构造，在无参构造方法中使用 本类中@Autowired的变量会抛空指针异常！！！！！！
  @Autowired会自动调用构造
  https://blog.csdn.net/qq_41426990/article/details/119928396
  
- 发布与监听模式的优点是什么？适用什么场景？
  就以propertySource的源的初始化为例，需求 有两个默认的propertySource必须有，后续的其它允许自行扩展，spring用了 事件发布--监听机制，可以自己重写监听器，配置的方式替换实现； 
  要我写的话那就直接设置一个配置参数就好，读取参数 转换为List，逐个添加；
  相比之下，直接进行配置，配置参数是需要是实现约定好的【即PropertySource需要提前定义好】，自己操作的空间有限；重写接口的方式，不对你的增强、补充做任何的限制，甚至可以是系统预料之外的内容 所以可以重新定义一个PropertySource都没有关系； 

- 切点 + 通知  实现防重复提交
  - 1.启动失败，@Pointcut注解的包名未改； https://blog.csdn.net/cc007cc009/article/details/106619277
    2.无法用于类，改注解的@Target；https://blog.csdn.net/qq_40241957/article/details/98079523
    3.@RepeateSubmit无法监听类上的注解,@within()||@Annotation即可同时监听方法和类；  https://blog.csdn.net/LiZhen314/article/details/126129368
    同时，后处理方法中获取注解的时候也要注意，方法上获取不到的时候要去获取类的注解 method.getDeclaringClass().getAnnotation(XXAnnotation.class)；https://blog.csdn.net/baidu_19338587/article/details/103877469
    4.返回值转换异常，@Around可以修改返回值；https://blog.csdn.net/weixin_39452731/article/details/84997458

- spring注入对象的几种方式及区别

  - **spring注入对象的三种方式：**

    [**https://baijiahao.baidu.com/s?id=1714296403354500918&wfr=spider&for=pc**](https://baijiahao.baidu.com/s?id=1714296403354500918&wfr=spider&for=pc)

  - **属性注入的几个注解的区别：**

    [**https://blog.csdn.net/wasane/article/details/123164683**](https://blog.csdn.net/wasane/article/details/123164683)

- @registermapper注解：

  - 个表对应的mapper接口都会有一大堆的继承，很不好看，所以将他们整合成一个mapper接口，通过继承这个接口来继承我们想使用的所有mapper接口**； [**https://blog.csdn.net/qq_41505160/article/details/124212697**](https://blog.csdn.net/qq_41505160/article/details/124212697)

- **@Autowired的实现原理？？？？**
  - **不使用@Autowired的情况下注入Bean；**
  - **注解的本质是接口，接口的代码在哪里？ ApplicationContext供变量的逻辑在哪里？**
  - **https://www.jb51.net/article/81077.htm**
  - 在工具类中使用mapper，需要在类上加@Autowired注解 ;   https://blog.csdn.net/weixin_42030522/article/details/104893868

- **No bean named ‘XXX‘ available问题解决**

  [**https://blog.csdn.net/ahornbeast/article/details/116051606**](https://blog.csdn.net/ahornbeast/article/details/116051606)

  **tkmybatis也是；**
  
- spring 启动类启动异常：

  - 使用内嵌的tomcat： 正常来说， 启动Spring Boot启动类即可，会启动内置tomcat；
    主类解决方法（绿色箭头nothing here）
    https://blog.csdn.net/qq374461948/article/details/105857332

    Invalid and restart idea之后，绿色箭头也没有了；Application的位置注意下，得是src/main/java/Application；然后启动里面，点+，点Application，选对模块、类；

- failed to excute goal org.mybatis.generator
  Cannot resolve classpath entry：可能是pom文件被人限制的路径访问权限；

- 事务相关

  - 基础：事务注解可以加类 / 方法上，使用简单；如果需要回滚同时返回异常信息的话的话需要手动回滚
    - @Transactional( rollbackFor={Exception.class,其它异常}) 
    - https://blog.csdn.net/wjxbj/article/details/84793080 
    - 如果父方法被标注为@Transactional，且子方法设置了setRollBackOnly，则返回前还会抛一次异常，不建议设置controller为@Transactional
  - spring事务常见用法 加上serviceImpl上；指定propagation= Propagationl.REQUIRED, rollBackFor = Exception.class
    spring事务的基本原理+三种事务传播类型 REQUIRED REQUIRES_NEW NESTED；
    关注四个问题即可区分；
    Spring 事务失效的几种情况；
    https://zhuanlan.zhihu.com/p/556397052?utm_id=0
    默认情况下,事务遇到RuntimeException 时会回滚 . 遇到受检查的异常 是不会回滚的. 要想所有异常都回滚,要加上 @Transactional( rollbackFor={Exception.class,其它异常}) 
    https://blog.csdn.net/wang5701071/article/details/108663948

- swagger简介

  - 什么是swagger?//丹姐发过调试页面，可以玩一下；
    Swagger 是一个用于生成、描述和调用 RESTful 接口的 Web 服务。通俗的来讲，Swagger 就是将项目中所有（想要暴露的）接口展现在页面上，并且可以进行接口调用和测试的服务。 PS：Swagger 遵循了 OpenAPI 规范，OpenAPI 是 Linux 基金会的一个项目，试图通过定义一种用来描述 API 格式或 API 定义的语言，来规范 RESTful 服务开发过程。 Swagger 官网地址：https://swagger.io/Swagger 有什么用？从上述 Swagger 定义我们不难看出 Swagger 有以下 3 个重要的作用：将项目中所有的接口展现在页面上，这样后端程序员就不需要专门为前端使用者编写专门的接口文档；当接口更新之后，只需要修改代码中的 Swagger 描述就可以实时生成新的接口文档了，从而规避了接口文档老旧不能使用的问题；通过 Swagger 页面，我们可以直接进行接口调用，降低了项目开发阶段的调试成本。
    https://blog.csdn.net/qq_41962258/article/details/118959582

    为什么添加了@APIModelProperty[似乎只是添加了属性说明用于自动生成文档]注解后就不需要覆写方法了？害，和@APIModelProperty无关，是@Data注解的关系；
    @Accessors
    https://www.jianshu.com/p/bc01f3cf235d

- http 返回值处理相关

  - response.setContentType  https://blog.csdn.net/weixin_37202952/article/details/83212148 
    response.setHeader   https://blog.csdn.net/ccmm_/article/details/80885094

  - No converter for [class XXX] with preset Content-Type ‘application/octet-stream；charset=UTF-8‘ 
    接口返回值改为null即可：
    https://www.cnblogs.com/zwh0910/p/16731960.html
    关键点就在于上述的响应头固定了是返回流数据，设置兼容其它格式或者在这样设置：
    https://blog.csdn.net/qq_15003505/article/details/126582418

    前端下载文件时处理后端有可能返回文件流，有可能返回报错信息的情况。
    https://blog.csdn.net/zongmaomx/article/details/128397355

- 似乎只要开两个idea项目之后，项目就会起不来了，应该是idea缓存出错；

- 又一次shiro报错，error creating bean with name dataSource-o
  但是注释掉maven的ma依赖，再重新刷入问题解决？？？？大概率是依赖冲突的问题；（加入笔记）

- gitlab相关

  - git 常用回退命令
  - Git回退commit $ git reset [--hard | --soft] HEAD~n
    - Git add后回退命令  $ git reset HEAD 文件名
    - https://www.python100.com/html/93663.html
  - 【git】Idea使用 Undo Commit,Revert Commit,Drop Commit区别（undo commit可以在本地保留代码修改）：https://blog.csdn.net/qq_44461217/article/details/123702791 
  - merge冲突管理，本地切到1.2.0，然后merge 1.1.9到1.2.0然后处理冲突、push即可（merge过来的内容是默认commit的），可以配合idea使用；
    在git网站上的merge和，本地pull、本地merge的冲突管理稍微有点不一样，本地pull、本地merge的时候似乎是直接就把本地修改了。
  - 安装、入门
    - https://cloud.tencent.com/developer/article/2134190
      https://blog.csdn.net/u014426593/article/details/118052310
      Git init; git clone;
  - 本地merge的操作学习下（结合IDEA+git插件的一种处理方式就是本地先到1.1.8更新代码，然后切换到1.1.9merge就好【视情况提交即可】；命令行上的merge的话，可以自己学习下）；
    本地冲突处理流程，最终还是要自己敲定冲突文件的最终版本（所以还是用idea相对好些，可以可视化处理冲突）：
    https://blog.csdn.net/weixin_45597885/article/details/129464448
  - GitLab 推送代码提示 A default branch (e.g. master) does not yet exist for xx/xx
    作为一个developer ，没有权限去创建默认的master分支，需要管理者去创建一个
    https://blog.csdn.net/javanbme/article/details/114531721
  - git的merge逻辑：
    有冲突时会接受你的提交；然后merge操作视作你的第二次提交；
  - Could not retireve the pipeline status; 应该是有提交打板没打到，开发 验证重新打个版本；
  - 还是每完成一个或者多个小功能就提交下的习惯好；

- 自定义注解的声明、定义：
  https://www.cnblogs.com/east7/p/14349994.html
  注解本身只是个标记和  属性的集合，要发挥效果生效通常要结合其它的工具，如通过getMethodAnnotation方法判断方法上是否有特定的注解、结合切面(@annotation 对有特定注解的方法执行特定操作)、结合其它的注解、
  https://www.jb51.net/article/169024.htm

- Mybatis相关

  - Mybatis trim 用法：
    https://blog.csdn.net/qq_42222342/article/details/106823507  
  -  

batch没有问题，scheduled??报错

sheduled中没有@ComponentScan注解，去扫描base里的配置！！！！(它那个不指定模块名，是默认所有模块吗？因为可以扫描到base)

https://blog.csdn.net/qq_35885488/article/details/80475309

 

常用注解：

@RequestMapping用法详解 

https://www.cnblogs.com/kuoAT/p/7121753.html

 

@RestController指定函数的返回结果直接写入方法体，而不是写入视图进而渲染？？？返回json需要@ResponseBody和@Controller配合。

即@RestController是@ResponseBody和@Controller的组合注解。

https://www.cnblogs.com/mySummer/p/9075422.html

 

\1. 依赖相关

检查 测试下批量代码(ip解析部分 整体的)

//添加依赖的时候，除了maven中添加之外，还要在dubbo中添加才能扫描到（启动的扫描路径配置了dubbo）

 

2.文件导出 controller返回值

**Debug:导出文件没数据时页面会崩溃**

**导出文件时若没数据，也导出一个空文件，否则页面会崩，估计时因为response入参的问题，具体为什么还不清楚；  以后调mapper，尽量log一下count，很容易找到问题了.**

 

#### 常用的通用技术

- 分布式锁
  - 加了redis分布式锁，依旧可能执行多次(自己写个redis分布式锁吧？hades版不大行，之前学flink也有了解  技术小结总结过？？)：
    为方法的执行速度过快，导致A实例执行完并删除锁后，实例B才开始加锁的情况。
    https://blog.csdn.net/liangfenxuegao/article/details/125292316
    定时任务执行的逻辑是调用异步方法执行，导致对应的已获取分布式锁被快速的释放
    https://www.cnblogs.com/charlesfbsxu/p/16642012.html
  - 学习分布式锁、定时任务的使用；//睡1秒，时间应该就同步上
    - https://www.cnblogs.com/ssskkk/p/10324158.html
    - Redis原生的SETNX原子操作；

- SnowFlakeSequence.nextId()用法？公司的Snowflake沿用teitter开源的snowflake方案的 bit位设计 1+41+10+12 ，依次对应1bit不用，41bit时间戳，10工作机器id，12自增的id，可以保证整个机房唯一； 时间周期为69年； //对于我们的应用，有时间戳 单机器不重复；有机器id，两台web服务器（可能还有德清）之间也不重复，故可以满足需求;
  其它实现方式网上还有很多可以自己实现下；

4.

excel导出日期格式设置，或许可行？
https://blog.csdn.net/m0_59259076/article/details/122477891

- cannot get a string value from a numeric cell
  https://blog.csdn.net/qq_35893120/article/details/80395080

####  Flink开发注意细节

(flink+impl, flink测试前记得注释provided，打包前记得取消注释！！)  //flink那个注释掉provided是什么意思？(provided和compile相对应，compile在编译，运行，测试，打包都生效；而provided假设目标容器已经存在对应的jar包，只在编译、测试生效，故compile打包后有依赖包，而provided打包后没有依赖包。https://blog.csdn.net/u013704227/article/details/46460913 )

 

flink运行LMOB0021时需要一个跑批的规则支持，需要跑批----即运行下odsRedis这个Job，把一个滑动窗口数据刷到Reids里

 

#### 代码调试

- 批量开发的话，打版的时候注意选中batch！！！！！！！！！！！！
  自己调试controller的话，和前端的请求差了一个/api !!!!!!!!
- //本地批量跑不通，大概率是域名解析的问题（为什么测试服务器就可以？）； 
  meta server address fallback to for env unknown
  竟然是VM参数写错了，-Denv写成了-Devn
  https://blog.csdn.net/vszhii_2679/article/details/109149864
  https://blog.csdn.net/zjh_746140129/article/details/86364371
- 索引不到文件两大操作： invalid cache；删除.idea文件夹然后重新打开；
  git有冲突没有处理，可以在分支那里，右键，强行merge；

1.

控制台启动报错：

an illegal reflective access operation has occurred

或者  error creating bean with name ‘shiroFilter’

可能是因为java版本不对，之前是java11

2.

IDEA中添加了依赖，但是无法导入类？可以查看maven依赖是否有包以及类；左边External Libraries是否有对应的包以及类；左边没有的话可以考虑IDEA缓存的问题，清下缓存并重启；

3.

提交之前sonar扫一下代码！！！伟健发的那个？？//fianlly里面不能有return

4.

dubbo调用Failed to invoke remote method异常解决: 是因为服务没启吗？
是的，dubbo最后还是要调我们服务器的方法；



Consider defining a bean of type ‘xxx‘ in your configuration
要在console的dubbo配置文件中添加afrulemanagerServiceImpl才能找到实现类；
compscan只能扫描到service，impl还是通过dubbo指定；
https://blog.csdn.net/a532672728/article/details/77702772

5.

代码有报错可能会导致maven依赖刷新失败；
启服务报错，shiro注入失败，之前是java版本的问题，这次是Jar包依赖冲突，base包中添加包后；直接导致服务起不来；考虑把导出相关的代码迁移到服务中吧?(不然batch中也要exclusion)

又一次shiro报错，error creating bean with name dataSource-
但是注释掉maven的ma依赖，再重新刷入问题解决？？？？大概率是依赖冲突的问题；（加入笔记）





#### **投产流程及注意事项**：命令打完仔细检查下，回车按慢一点！！！

- 投产遇到的问题总结，思考下：
  1.验证环境的操作需要完全和生产一致，==本地不要连验证环境！！！多看日志==。
  2.Elastic job的测试，一定禁用其它所有服务器！！！
  3.生产的验证文件尽量在测试环境先验证下；

1版本下载

90 92 申请会同，hawq，gpadmin

中转机1，kftczy，找对版本号之后，新建文件夹（lrhyyyyMMdd），复制版本过来，拷贝项目组文档到本地

 

1.5apollo修改参数并发布

 

2.数据库普通脚本投产

连数据库，cd /home/admin/weihu/,新建文件夹(yyyyMMdd??)，更换当前目录到新文件夹？？备份(部署手册上有命令)；上传脚本(winSCP)，登录cli，use数据库，执行脚本

 

3.hawq脚本投产

切换到/home/admin/script (里面的hawq脚本是要定期执行的)

对比export….sh(确认配置啥的没问题)，然后备份？替换….sh

上传export list； 更换当前目前？；运行，要加日期

 

4.hawq数据库投产

导出del见数据库模块；联系？？处理del；  登录hawq机器，DB， cd adm_irc_update; mkdir 20210122; mkdir PROC; mkdir TAB_ADD; 上传相关文件； sh run_hawq…sh； 建表和porc

 

登录server； cd 命令中的路径？？； 替换cfg和tablelist; 逐条执行投产手册的内容

 

5.flink投产

//下面这一步是先停止还是先上传不很确定

停止Flink集群 进入bin/目录，  ./stop-cluster;

逐台服务器替换common包，在node1启动，进入bin/， ./start-cluster.sh

flink服务器停止服务，备份common代码，文件中转站上传flink-common代码，启动common

文件中转站上传所有的 flink-jar包//到那台服务器？？？

打开flink的页面，逐个启动应用

观察运行情况，五分钟内不挂掉

####  服务测试技巧

\1. 想要让soap调自己本地的接口，只要把测试服务器的服务关掉，然后soapUI直接调用即可；

//本地测试flink或者redis  服务的时候记得把服务器停掉！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！

 

\2. error creating bean with name meterRegistryPostProcessor:

最后发现是不知道什么时候不小心把配置的java8换成了java11

 

\3. Invalid bound statement：

- Invalid bound statement (not found) 换方法，==0.换Mapper，看看是单个文件、方法的问题还是idea环境配置的问题；==（将pom文件 最后的resources 那段注释掉[tk自动生成需要用到]，然后重新刷新maven，问题解决）；
  其它的Mapper也有问题，且所有环境配置试了下 ==1.重新拉代码、2.清idea缓存、3.刷新maven、4.jdk版本检查都没用，最后发现是5.有人改了pom文件，添加了resources那段脚本==
  此外：深刻理解了下resources注解是把非java文件打包进class；而报错的含义是class中找不到对应的xml文件；
  补充：默认xml都打进来；指定了一处xml之后，其它地方打不进来；
  https://blog.csdn.net/weixin_43888891/article/details/122406081

  tk的selectByExample可以，但是自己定义的方法找不到xml，大概率就是pom文件的哪个配置问题[pom使用tkmybatis generator需要注释掉文件路径的问题]；

- 单个文件的问题的话：检查namespace, id;  //更新下代码； maven clean，刷新依赖；idea invalid caches；  

#### 业务相关

\1. 转账中 渠道事件的定义 可以看 IRuleChecker类；面具估计  00120 121 122 123 125 126

 

\2. 分行，account_manage相关；

**//****先理解为cif_id查af_account_manage的CUST_ID吧****，），或者问问沈悦，****还有企业的cif_id是什么(应该是从组织机构代码截取一部分****)？** **上次那个每个人有个客户经理是哪里？（是af_cust_busi_info_ind表，可以跟踪到客服编号-一级分行； 对应的af)cust)busi_info_ent是企业的账户信息）** **顺便把account_manage字段都过下，看下有没有问题  ；****目前取一级分行的策略是查org_split_afl_brch_rela**

 

 

\3. Af_hitresult表的维护逻辑：

hitresultConsumer;  hitresultServiceImpl

Af_hit_result表数据接过来的逻辑，首先是网银在自己的表初始化一条记录，发起任务；然后我们这边通过kafka接过来；接着移动办公 依据处置结果调我们的接口更新hitresult 并视情况发送给柜面，柜面处理完再更新我们的hitresult，任务结束（我们的接口会更新hitresult并执行对应的操作）

//TiDB那边除了初始的记录，后面也是可能会更新的；

 

HitResultService.addRestult()代码阅读：

changeStatus//将数据库hitresult的OpsStatus字段设置为1;  为0则表示对应的操作如外呼还未执行，为1表示已执行；

handle(); //依in的情况情况执行对应的操作(HitResultHandler)并更新OpsStatus;会依据hitresultIn更新chl_res字段

insertAfHitResultRecord//插入记录到hitresut_record

 

hitResultConsumer代码阅读：

@KafkaListener注解中，topics指定主题，其中用${}表示从配置中读取参数；contanerFactory指定kafkaConsumerConfig中的消费者工厂类，可以指定消费者并发数量；

EventData等类是ticdc中的类，tidb是将SQL转换为KV键值对存储的，那么对于ticdc而言，它需要将原始的KV键值对(byte数组)反向解码成SQL Event(有sql含义的对象，如DML/DDL)

https://www.jianshu.com/p/aab22aa4d365

//看到的网上示例输入是List，项目中是COnsumerRecord，不知道什么区别？

 

\4. 白名单相关说明：

af_white_list(转账 老) , af_white_device（登录 老）, af_white_fraud（登录+转账  新）; 

//flink TMOB0051 长期不动户激活（redis中维护）后第一笔转账小于10元入管控名单，后面有转账大于5万元的动作，才可能命中

 

\5. Applyno  开户、管户说明

**applyno是渠道端生成的，专门给我们用的； 和核心的核心流水号(login trancheck 不大好弄)是不一样的；**

**核心客户号和我们这边的账号、客户号应该是对得上的；**

 

**开户和管户的区别？** 

**开户一般就是管户，后面可能会有到其它网点换卡的操作，****具体可以温ic卡系统的同事？**

**//(acct_busi_info , control_list都是开户机构)；)   account_manage中存的是管户的机构编号**

 

6.客户号、cif_id、账号、卡号

//  机房看loginlog的cif号码（确认下身份证号 是的）; 哪里有客户号？(login trancheck表只有一个cif客户号) ;  cert_id;  acct_id（账号 确认下卡号 是的）;

客户号: 对公是社会统一信用贷； 对私就是身份证号；

Cif_id: 对公是社会统一信用贷； 对私就是身份证号；

账号：对私就是卡号；对公有账号

卡号

account表的custId是证件号？？？？？？ 是的

 

7.Account_party的hawq加工逻辑；run_hawq_replace_data.sh脚本学习

Account_party的hawq加工逻辑是增量的，只处理前一天的交易记录并提取出数据；

//理解下account_party脚本的内容；

truncat temp表; truncate之后插入数据，自增id从1开始；

全量数据入temp表

//查询temp表的行数；

然后分批replace into正式表//50000为单位，而且是连id一起的replace_into

---有一个问题，account_party只会处理一天的数据，是增量的；temp表的id在truncate之后会从1开始； 会错误覆盖正式表中的数据，因为正式表的id是唯一索引；

 

\8. org_id，org_nm的映射表在哪里？//最后用的是李淋雨给的那张表？？？Dwd_d04_acms_org_info

 

\9. pb_tranflow表的数据来源

手机银行流水表：记录流水（pb_tranflow没有核心流水号）； 处置流程会先调我们的风控接口 并送给我们一个随机的单号 applyno，处置通过后 才会调核心的接口，并得到一个核心流水号（并通过直接没有核心流水号）；

//还有一个问题要首先确认，我们的这几条规则的处置结果是什么？在风控那里是否是算通过的。



10.controller中已有的xml文件导出流程

导出xml文件流程：
指定文件名；
获取返回的数据；
数据类型转账成export版本；
//调用ExcelUtils的export方法得到Workbook
Workbook sheets = afComplexRuleService.exportDConsoleReportFinal(resultList, fileName);

//把Workbook中的数据写入到response中
Sheets.write(os);

//还需要reponse，问题是用已有的还是自己写，先用已有的吧，如果不好用再考虑优化；
//workbook无法通过fastjson序列化，

左括号的字符串转义是\\(
https://zhidao.baidu.com/question/160407245.html

 

11.

数据库服务器申请流程：
找陈康申请云管平台账号（之前已申请）
主机管理->选择系统->申请资源；//没有系统的话可以让已经在系统的人拉你(之前已有系统)
按照云管平台操作手册申请；2.3.1;
修改密码：root密码；mysql初始密码；
//其它账户创建之类的参考之前的笔记？？！！！

mysql服务器申请克隆版：
cannot connect to local mysql server through socket；一开始以为是克隆的过程有问题，联系了阳文灿发现是mysql进程没启动；
mysql启动日志可以看 /var/log/mysqld.log ??? 阳说pid文件的归属是root导致启动不了，改成mysql用户之后就可以启动了；
用root用户启动；mysql进程启动命令：service mysql start/stop；
/usr/sbin/mysql文件是Mysql编译后的文件？？？



12.

只有login trancheck有cif客户号，个人账号的证件号就是cif客户号，看看行不行；只有TBEK0013是企业的，但是也是没有cif客户号的

#### QL表达式

- 公式计算的接口简单了解下:
  QLExpressUtil.execute --> runner.excute 
  Runner 类型为ExpressRunner，初始化的时候要添加别名：addOperatorWithAlias
  Runner.excute()方法入参：statement[注意括号要英文]  QLExpressContext 实现了IExpressContext并重写了get set  
  QLExpressUtil [实现了ApplicationContextAware] 
  规则引擎入门:https://www.jianshu.com/p/da8cbf4ef75d
  ==todo: QLExpress原理：if else怎么执行的，确实还是值得思考的？==

#### 企业微信相关

- ```java
  企业微信接口controller：
  	用户认证(未认证的SessionUtils.getSession()为null或session中userName为null)：SecurityUtils.getSubject().login()[来自shiro]  入参：UsernamePasswordToken[来自shiro]
  	校验请求编号
  	反射加载类  com.czb.ampa.common.WechatServicie类；  transno编号对应的方法的入参；  容器中获取对应WechatServicie的实例，WechatServicie包含所有的企业微信接口；  
  	反射加载方法   编号对应的方法
  	入参的body封装为Object[底层类型是入参类型]//gson.fromJson
  	反射调用
  	反射调用结果封装为JsonObject
  
  	如果是获取企业微信用户的信息：
  		把反射调用结果封装为UserInfoByCodeResponse
  		设置session的UserName
  		//超管企业微信工号切换功能
  
  todo:有点不解，Session_local.get()从我的角度看获取到的threadLocal对应的map，怎么就b变成session了？？
  有前端在定时调用获取session;
  ```

- ```java
  session控制  ThreadLocal相关 //todo:可以进一步研究下？
      //hades的SessionUtils图方便，在setSession时直接把 session设置进了threandLocals，依据key为 当前ThreadLocal.java对象 可以获取的当前threadLocals的session;
      Session的机制我大致清楚了，用的是shiro，
  //底层：当前线程， Thread对象的threadLoacls保存了线程的本地属性，{行内的hades中的sessionUtils} 依据key为 当前ThreadLocal.java对象 可以获取当前线程的session
      //行外的或许复杂些，例如org.apache.shiro: 当前线程， Thread对象的threadLoacls保存了线程的本地属性，是一个Map，依据key为 ThreadContext类名_SUBJECT_KEY   得到subject；subject有一个session属性；
  //hades的SessionUtils中的SESSION_LOCAL.get()可能为Null[当前线程threadlocals为空且自定义的treadLocal的setInitiialValue()采用的实现返回null的时候;Ampa而言应用启动后就已经不满足了，应该是threadLocals有值了，这一行step into进不去有些在意？？]，
      
      
      ThreadLocal学习：
  Thread类中有两个变量threadLocals和inheritableThreadLocals，二者都是  ThreadLocalMap类型的变量，[ThreadLocalMap类是ThreadLocal内部类，里面的table属性真正保存数据，为Entry[]类型，key为ThreadLocal<?>，vlaue为Object] [tips:父线程的threadLocals变量，子线程获取不到; InheritableThreadLocal变量可以被子线程获取的核心就是创建子线程的时候，Thread的构造会将父类的InheritableThreadLocal变量复制一份给子线程的InheritableThreadLocal；
  ]；
   threadLocal导致的内存泄露？
  threadLocalMap中的key是弱引用，可能被gc回收，则会出现key为null，value不为Null的情况；这需要实际的时候使用完毕及时调用remove方法避免内存泄漏;
  https://zhuanlan.zhihu.com/p/339957079
  ```

- 手机抓包教程

  - 查看手机ip:
    http://www.kindsoft.net/article/24433.html
    fiddler安装教程： 记得重启
    https://www.rstk.cn/news/201200.html?action=onClick
    抓包教程：
    https://www.xjx100.cn/news/677713.html?action=onClick

  

#### Flink相关业务逻辑

flink:现在配置的是8个小时，8个小时没有新的数据更新，和自己数据库的连接会断开，需要重启下任务。 

flink查看日志：进入flink部署页面；选择job，进入，点击taskManagers 查看该Job所在的host，前往taskmanagers 进入port所在的那一行，依据关键字查看日志即可



***\*flink-面具攻击的代码学习\****：

flink代码的入口 运行过程？

入口在(MOBFACEREGINF)，一般有四步（拉取数据，格式转换，数据筛选，数据处理），只需要在数据筛选过程中添加一个字段就好，内容是截取record_time

flink代码编写的框架?

​	现在来看，基本上就是主函数，然后新建四个类重写几个关键方法就好了

flink的代码如何进行测试？

​	有个代码注释掉provide；-Denv=FAT；然后自己在数据库修改一个字段就好了；部署到测试上之后呢？修改上游的数据，数据库应该就会变化

 

***\*面具攻击相关的flink代码细节？\****

1.修改TiDB上游数据，flink才会重推数据，执行插入或修改？  

2.TiDB可能会因为表结构更新等原因，重推已经推送过的数据，所以，更新时间是半小时之前的数据，不做处理

\3. 相对于我现在如果想要为以前的所有字段+日期 列，是不可能的？！除非修改update_time?

//判断绑定设备是什么意思？（进行过设备绑定（即设置为常用设备），则不计入面具攻击的累计）

 

flink项目好拉跨；只能从root执行clean  install；不能从单个项目直接执行clean install



 

#### 运维相关

数据库服务器迁移流程：

验证环境数据库新建用户；修改apollo对应的数据库配置；重建和迁移表;  修改flume3密码（encript加密？）；mysql的export_data.sh的密码（base64加密， 大数据风控那边有工具类）;

拷贝数据库文件夹；mysql配置；

 

服务器创建新用户：https://www.cnblogs.com/yanshuai0922/p/11530449.html

mysql创建新用户：http://c.biancheng.net/view/7490.html

mysql> GRANT SELECT ON*.* TO 'test3'@localhost IDENTIFIED BY 'test3';

修改服务器密码：(root monitor admin mysql)

Passwd userName

https://blog.csdn.net/wd520521/article/details/109766046

修改mysql密码（root 记得加分号）：

http://c.biancheng.net/view/7152.html

 

Navicat:  Host XXX is not allowed to connect to this MySQL server。

https://blog.csdn.net/h985161183/article/details/82218710

CREATE DATABASE [IF NOT EXISTS] <数据库名>

[[DEFAULT] CHARACTER SET <字符集名>] 

[[DEFAULT] COLLATE <校对规则名>];

 

scp用法（两台机器能Ping通就可以用）：

https://www.runoob.com/linux/linux-comm-scp.html

 

验证数据库 配置文件迁移；/etc/my.cnf;//whereis找到， scp分发；

 

对比两个jar包，把两个Jar包放到一个文件夹下，然后idea打开，选中两个jar包，右键，compare；

[https://blog.csdn.net/qq_32077121/article/details/118142637](https://blog.csdn.net/qq_32077121/article/details/118142637)

 

Svn查看merge修改没有：

1.9.1的文件夹打开，svn merge，选中1.9.0，然后show log;

#### IDEA使用

- idea自动补全只有左括号,缺少右括号的问题解决
  https://blog.csdn.net/qq_45826803/article/details/120846655 
  
- Load error: undefined path variables
  https://www.cnblogs.com/evan-liang/p/12233949.html
  
- idea  maven设置默认拉取最新的snapshot
  
  - //taip测试环境的包可能被老的maven覆盖；sanpshot应该会自动更新到最新的版本，idea配置即可；
    Idea  maven snapshot包，不会去拉最新的snapshot包，可以在idea--setting--maven, 打勾 always update snapshots，然后刷新maven、打包package的时候都会自动去拉最新的snapshot(包里面是新的，idea里面还是要手动刷新的)
  https://blog.csdn.net/Dkangel/article/details/108362670
    http://c.biancheng.net/maven2/snapshot.html 
  
- idea手动导入jar包；
  https://blog.csdn.net/weixin_46028577/article/details/106342938/
  
- 解决SpringBoot测试时出现:Unable to find a @SpringBootConfiguration,you need to use @ContextConfiguration
  https://blog.csdn.net/wasane/article/details/123315918
  添加了application类后，变成了：
  找不到xxxtest

  添加插件
  https://blog.csdn.net/qq_45900875/article/details/123157760
  改了设置，错误又变了
  https://www.cnblogs.com/52yu/p/14329943.html
  Failure to find was cached in the local repository
  用maven插件的clean
  https://blog.csdn.net/lihaiyong92/article/details/95672645
  又报错找不到Pom：
  用maven插件的 isntall之后
  Error creating bean with name shiroFilter
  发现是shiro相关的配置类重写后在app，导致impl这边加载不到；

- app无法启动，工程目录下删除.idea文件夹；idea重新打开parent和.idea在一个目录，然后app可以启动；

- idea生成单元测试类：
  https://blog.csdn.net/weixin_47627102/article/details/123821714
  idea测试相关类导入失败（如SpringBootTest，SpringJUnit4ClassRunner），但是依赖已经添加，可能是没有把test.java标记为test source directory

- idea pom.xml 上有斜杠
  https://blog.csdn.net/he_xin2009/article/details/124435774
  Command line is too long
  https://blog.csdn.net/qq_35448165/article/details/113090864

- Failed to resolve org.junit.platform:junit-platform-launcher:1.5.2
  https://blog.csdn.net/shiniannian/article/details/104743742/
  
- javaJDK isn‘t specified for module //删除.idea; invalid cache and restart;配置好maven 
  https://blog.csdn.net/secretstarlyp/article/details/111186188 
  
- idea 把文件夹加入到git控制:
  注意idea project路径目录  是否 和.git的路径目录一致，之前.idea在.git外面一层，所以新建的文件夹无法被git管理；  在.git这层重新构建.idea文件即可；
  
- IDEA git 忽略文件最佳方式;右键可以添加，也可以选择文件夹，然后shift两次搜索.gitignore//已存在的.idea等文件可以直接删除
  https://blog.csdn.net/bbj12345678/article/details/122836217
  https://blog.csdn.net/myinsert/article/details/126074704
  
- Idea version使用：
  https://www.jianshu.com/p/27729eea0b25
  
- pom.xml有删除线
  https://blog.csdn.net/qq_41312061/article/details/126884392
  
- parent.relativepath of pom
  https://zhuanlan.zhihu.com/p/453547775
  
- 整理下思路：从头构建一个5层的项目：如何配置tomcat还没整明白
  idea设置项目为maven
  配置maven；恢复右边小窗，复制Pom文件过来，重新载入
  新建子模块，子模块配置maven，复制pom过来，重新载入；
  设置git，把.idea等加入到gitignore，然后删除已存在的.git文件夹；
  
- idea可以在项目中添加模块！！！即base batch等；

- idea断点调试，
  - 左上角可以切换Debugger和Console；
    intellij idea 调试只能调试一次，第二次不能进入断点； F9执行完下次还能进（之前用的run to cursor不能二次进）；
    https://www.jianshu.com/p/5c57f49c9828?utm_campaign=maleskine&utm_content=note&utm_medium=seo_notes&utm_source=recommendation 
    https://blog.csdn.net/weixin_45324716/article/details/114705449
  - Method breakpoints may dramatically slow down debugging 
    把断点一个个去掉就好；
  
- idea 右键 没有diagrams
  https://blog.csdn.net/qq_40012458/article/details/111334334
  
- Mvn dependency:tree用法；
  mvn dependency:tree
  如果想看冲突和重复的具体情况,用verbose参数：
  mvn dependency:tree -Dverbose -Dincludes=commons-collections
  https://blog.csdn.net/djrm11/article/details/107268555
  https://maven.apache.org/plugins/maven-dependency-plugin/tree-mojo.html

#### 其它组件

- wps
  
  - wps怎么设置单元格只能输入指定内容
    https://www.baidu.com/s?ie=utf-8&f=3&rsv_bp=1&tn=57095150_dg&wd=wps%E6%80%8E%E4%B9%88%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E5%8F%AA%E8%83%BD%E8%BE%93%E5%85%A5%E6%8C%87%E5%AE%9A%E5%86%85%E5%AE%B9&oq=wps%25E5%258F%2596%25E6%25B6%2588%25E5%258F%25AA%25E8%2583%25BD%25E9%2580%2589%25E6%258B%25A9%25E5%259B%25BA%25E5%25AE%259A%25E7%259A%2584%25E5%2586%2585%25E5%25AE%25B9&rsv_pq=b45ddb6d002f29f0&rsv_t=b28d9drvTmveW3V7xjujWZaSwSN6Mw3pZZ%2Fj2edfgysp5gCg65UELB0yqj9NGd6rybU&rqlang=cn&rsv_enter=0&rsv_dl=ts_1&rsv_btype=t&inputT=9818&rsv_sug3=92&rsv_sug1=79&rsv_sug7=100&rsv_sug2=0&prefixsug=wps%25E5%258D%2595%25E5%2585%2583%25E5%258F%25AA%25E5%2585%2581%25E8%25AE%25B8%25E8%25BE%2593%25E5%2585%25A5&rsp=1&rsv_sug4=9818 
  
- https相关
  
  - telnet端口通,ping不通
    https://answer.baidu.com/answer/land?params=VljU4h0Gzkx9%2BaoN0V5vDNjrR7SEgCvRxCG96%2BzRgwA12%2F%2BWSIzL6b0YkCYgENhFdkvxDYPKr%2FfLj%2FEDzyaPIU20rXFa8J2hf3ERI8spicnx31WpX3Ak0upu1qSf%2FKgMf5kAiRqGsszZNHyfuW90zce6qsxp7AXSz0itU4%2BQxPD23qEoZkgNRmN4O0seNpdB&from=dqa&lid=b55bd8f4006bd4a7&word=telnet%E7%AB%AF%E5%8F%A3%E9%80%9A%2Cping%E4%B8%8D%E9%80%9A
  - 开启telnet
    https://www.wm300.com/jiaocheng/328718.html
  - win10本地域名解析 //host配置
    DNS查找顺序：浏览器缓存> 本地操作系统缓存> DNS服务器(路由缓存>互联网 DNS缓存服务器)
     互联网DNS服务器, 是路由缓存的上一级, 一般为宽带运营商， 一直到最后, 最全的就是根服务器, 一共13台, 通过物理文件的冗余, 分摊全球的域名查询任务
    https://blog.csdn.net/qq_30351747/article/details/123642534 
  - Nginx 400 Bad Request | The plain HTTP request was sent to HTTPS port
    https://blog.csdn.net/weixin_33929309/article/details/92201668
    如果是nginx转发nginx，注意转发后也得是https不能是http；
    或者考虑参考下面整个配置upstream（还没试过？）
    https://blog.csdn.net/qq_45752401/article/details/125487516
  - 如何查看ss证书的有效期: pem格式
    https://www.cnblogs.com/wusenwusen/p/17516081.html
    如何配置ssl证书
    只需要把文件放在Nginx配置文件指定的目录下，证书更新完一定要重启Nginx！！ 可以ps -ef | grep nginx查看；kill 关闭； sbin/nginx  -c  nginx.conf启动；
    https://blog.csdn.net/qq_41481367/article/details/132331520
  - 您计算机的日期和时间不正确,因为无法于建立私密连接
    时钟问题  或者  网站ssl证书过期
    https://www.sxseo.com/wangzhananquan/387.html
    https://baijiahao.baidu.com/s?id=1771362742684885573&wfr=spider&for=pc
  
- quickbi
  
  - quickBi【如果设置了行级权限】仪表盘权限（控制是否有页面权限）和数据集权限（控制是否有数据查看权限）是两码事；
  
- elastic job
  
  - //定时任务对比ctm调度的不足：无法添加依赖（以前的ctm依赖通过生成文件和文件检测的方式实现；有必要的话应该是可以通过 数据库记录+java睡眠的方式实现的）； 无法设置入参（故一旦执行出错，无法重新执行某一天的批量，需要研究下，讲道理应该可以设置入参）；
  - 定时触发失效？服务器维度页面终止其它服务器即可；//应该是调到其它服务器去了；
  
- shell脚本  
  
  - linux查看操作系统版本  cat /etc/os-release
    linux查看指令集  lscpu   
    linux查看文件编码 file -i filename 
  
  - vim中字符串的替换：https://blog.csdn.net/Wang20122013/article/details/123897210
  
  - shell脚本中$?什么意思
  
    https://blog.csdn.net/qq_32907195/article/details/109308037
    多指执行bai命令，一般在程序里面du会对其进行判断，如果发现上一行的命令执行有误，该脚本就会终止执行。
    if [ $? -ne 0 ]
    then
    #脚本不正常退出
    exit 1
    fi
  
  - Win10安装telnet客户端：
    http://www.mofazhu.com/jiaocheng/win10/36842.html
    https://blog.csdn.net/AlunX_daren/article/details/100881305
  
  - windows上传文件到Linux：sftp需要人机交互，免交互需要安装软件 lftp expect 生成密钥对；
    http://t.zoukankan.com/huangmr0811-p-5571003.html
     ftp linux脚本倒是有命令，但是windows没有找到能用的；
    https://blog.csdn.net/xueshenlaila/article/details/117699296
    
  - ls -alS 这个命令可以按文件大小从大到小列出文件; 
    Du -sh 文件名 //可以查看文件大小；
    //Du -s * | sort -n
  
  - 查看文件的md5： certutil -hashfile 文件名 md5；
  
  - mysql shell中不知道source是否支持空文件？支持的
  
  - Kill java进程失败，sh shutdown脚本没能停止脚本
    用kill -9 ;
  
  - 自动化部署失败，ps -ef | grep ampa还能看到shutdown、sleep等命令待执行，看了下内存free很小但是buff/cache很大，需要清理缓存：
    $echo 3 > /proc/sys/vm/drop_caches:表示清除pagecache和slab分配器中的缓存对象。
    https://betheme.net/news/txtlist_i256731v.html
  
  - Linux mv命令：https://www.cnblogs.com/zxqin/p/13632816.html

#### 系统设计（架构）经验

- //这个思路还是值得借鉴的，上游推过来的数据，本地需要调整同时上游又有可能需要重推；上游推数到temp表；修改时同时update表和 data表（正式表）；批量  则清正式表，插入temp表数据，再利用update表更新data表 ；
- 后端接口做异步的一个思路，可以即时返回+ 运行结束时进行提醒
  - //异步方法 snowId要返回给前端，同时作为请求入参；  暂定延迟接口响应时间，无需调整；
    //新建一张表吧（异步调用执行状态纪录表），用来存绩效计算状态；snowFlakeId 时间戳  异常信息 ，调接口的时候设置（最外层执行保存代码浅） 为1，执行结束（异步线程的插入完成）删除纪录，异常了设置3并提示异常信息
    轮询接口：进入接口判断，当前模块  用户 无纪录或者距离当前时间超过1个小时（删除）且返回true；查询到3也会删除记录；  //轮询也设置时长限制吧？
- 对于数据列表中可能存在部分异常数据，记录并在返回结果中提示的模式可以借鉴下
- 需求澄清会：产品要先发相关内容  测试要参会  投产，Hawq编写人员要在?
- //表结构设计心得：第一，能用编号尽量不用文字；第二，需要连表的两张表一定要有能直连的字段，可以不是主键但一定要有且唯一；
- 一直琢磨着怎么传方法为参数，直接传接口就好了呀！！加一个lamda还能简化；
- 创建maven项目流程： 
  https://blog.csdn.net/weixin_42188778/article/details/124517098
  https://blog.csdn.net/weixin_46213083/article/details/124178951
  但是找不到tomcat，看了下项目 似乎行内用的是tomcat-embed-core；
  就先试试pom导入，发现parent pom用的是hades的pom；复制dide的parent pom到新项目；
  //依赖包小心不要加入到dependencyManagement中了，导入不进来的；

#### 生产问题排查经验

- 先看日志！！！！

- 索取源文件、数据，在测试环境复现问题！！！！

- //如果验证环境正常，生产异常首先考虑 数据异常、前端缓存问题、配置不同、生产的服务器状态（cpu 内存）；
  
  - 无法获取配置参数的原因定位到了，前端缓存没用好[前端什么问题？]，重新登录问题解决；前端优化、分行编号改为取lsBranchCode(让明磊夫返回下)；
  
- 和外部系统对接一定打印 输入  输出；接入 数据 打印数据量等关键信息；

- 验证没问题，生产有问题，大多数是配置问题（java版本、idea默认配置如-parameter等）或数据问题（特别是数据前后有空格情况）

- 问题排查：只有日志、代码、数据库是不会骗人的，记忆、理解是可能存在偏差的。
  批量代码的编写：逐行数据处理，一条数据的问题不想影响后面的数据，优先考虑continue，有必要的话套一个try catch，直接catch Exception。

- //流程中心进去慢的问题复盘：加载单个js文件失败，应该是pc端和Js文件不兼容； 永胜和川青可以是因为浏览器版本不一样，他们的浏览器超时时间短；
  //好好熟悉了流程中心的网络链路：前端的页面加载流程，到主页-----加载需要的组件（通常是nginx服务器上大量的css js文件）----执行页面的mounton方法；

  请求链路分析，逐步减少链路明确出问题的环节，最后罗列所有的可行性并逐个验证或排查；

  

#### 数据建模

- 召回率计算：

  https://zhuanlan.zhihu.com/p/369936908?ivk_sa=1024320u

- 语音模型：一个huggingface；一个aistudio；或者你github直接搜paddlepaddle；

- //xgboost要不简单学一下，玩一下；

#### 行内技术架构

- 数据索取流程：发起数据索取；一般第二天 消息提醒就有下载的地址；解压密码 流程号后四位@姓名首字母缩写；
- aws
  - aws注意事项：先要申请用户(也就是access、secret对应的)，然后开通用户到对应桶的上传、下载权限，然后可以上传、下载文件； 要开通 服务器到集群的地址 ，不同的集群域名不同；不同集群之间是不能互相访问的(即使是信创的终稿性能和信创的大容量也是一样)；//履职有信创中高+非信创中高；zdsxbg是信创中高； 
- spring batch原理，以dide为例：
  - springbatch批量xml配置原理；
    //批量的参数传递：
    Application获取入参；
    ---中间应该有读取dide-batc-job.xml，才找到了JobListener---
    通过JobExecution传递给JobListener；
    JobListener通过方法调用传递给dideMonitorService的monitorJob方法；
    dideMonitorService再调用对应的方法传递给服务；
  - 批量测试环境跑两次只有一次生效？dubbo调到别人那里了；批量也是有调用dubbo
- 网络隔离：外网访问dmz区服务器的nginx，dmz区再对应到行内的服务器；
- tidb数据同步原理应该是数据库上装一个软件，有变化通知tidb??  原理问一下王杨帆？cdc复制？//应该是监听数据库的日志；
- 想学hawq和业务来着的(hawq居然是数据仓库，TiDB才是分布式数据库https://search.bilibili.com/all?keyword=%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93;  flume-----java后台和大数据集群的传输工具,浏览日志 鼠标悬停等信息会写到磁盘，故可以用于日志的采集，  https://www.bilibili.com/video/BV184411B7kU?from=search&seid=5473143494338321001&spm_id_from=333.337.0.0), 帅帅上次的转账，数据库的数据迁移。
- 网络开通注意区分：
  是办公大楼的终端到 系统的前端；还是办公大楼的终端到系统的后端；又后者是系统的后端到系统的后端；；

#### 绩效中心业务相关

- 为什么一开始宁波分行没做线上化计算？
  - 宁波分行//工资费用  机构看板  风险借据也够了；
    //除了活动型收入，零售 等条线也有部分绩效是公式计算的；
    零售 小贷 公司条线 ，工资活动型【如信用卡活动：第一名奖励1000元等，没有稳定的计算逻辑】；   
    有稳定指标的条线：计财 运管；AUM可能增删产品； //打标规则经常变，T+1【保证客户经理连续两个月的收入相对稳定】所以北京的打标本地化
- 工资与费用申请   相关说明
  - 202301有个员工的一级部门不能回显示：二级分行做外包处理；(二级分行的人暂时不能回显一级部门，且不能像支行一样配置支行绩效综合岗[因为人力表subBranch字段为空]； 机构层级列表可配置，方便通过校验；) 
    所有的支行都需要添加到机构层级列表
- todo: 沈阳的、零售理财和杭分哪里不一样吗？沈阳就多了一个年度参数的配置？
- 济南分行绩效计算梳理：
  1.孙晓明老师 依据 公式算基础工资并发送  石珊珊  老师；
  2.石珊珊老师收集活动数据+孙老师的基础工资，汇总得到每月绩效；//但是月度的基础工资都是预发的，不希望客户经理看到，所以每月绩效不发布；每个季度会清算一次，是要发布的；
  3.孙老师使用工资、费用的场景：机构费用的发布； 季度 个人基础工资的发布；
- 绩效项   公式初始化，excel转insert
  - 1.case when调整为if else(刚调完，还需要核对下)；2.round去掉；3.有几个要一分为2；4.标黄的都是新增的，原来没有吧？白色的不用管？(修改)
    //营收效益积分一份为2，客户经理进一步拆除一个实绩项；  增量积分实际上是两个，最后增加一个总的 增量积分；

#### 反欺诈业务相关（照片是有的）

- 问：同步命中一条规则就返回？有没有可能运行中的规则会命中多条，但是你一条就返回了，后面的高危规则无法显示？规则有优先级，危险系数从高到低，找到命中的第一条并返回。
- 一直想找个机会研究下规则；

#### 浙银办公相关内容梳理

- 测试环境也可以配置(好像是格尔的平台) 域名-->ip，找杨学斌开通；
- oA的人员信息移动办公是实时对接oa，但是浙银办公是T+1的；控制台有自己的内管和腾讯的控制台；
- 定位下流程打开慢的问题：可以debug模式看console(ctrl shift alt d)即可；

#### 为人处事

- 领导的价值，在于努力提升整个团队的水平、价值和意义，某种意义上是务实的。而不是躺平，或是对着下面的人发呆。
以后学聪明点，氛围不对就少说话，最好别说话！！！！！！！！！！
  如果加班比别人少，又想在部门内生存的话，只有承担比别人更多的活，这是生存的规律；   你的加班时间和组内其它成员的加班时间应该是相近的，没有人能独善其身。 

- 技术沟通上

  - //不要轻易信任陌生人；  谁的问题让他自己汇报比较好；

- 绩效中心

  - 宁波 工资费用模块的部门列信息梳理

    - 明天把部门信息这块梳理下  
      工资费用：excel自填-->汇总 会依据pams_user_info表为准，不在的以填的为准 支行 部门[2级部门会依据人力表查询一级部门名字] 分行-->发布 会依据 支行、部门名字反向查询编码 ampa_org_info [包含了人力hrms_org_info的支行、部门]--->手工绩效发布结果查询，会查询用户在hrms_user_info的dept字段队以ing的一级部门，确定查询权限

      其它绩效数据：同工资与费用申请；

      发布：依据机构名查机构编码
      //查分行的机构[AmpaOrgInfo，依据分行为条件查询，orgSuper   机构编码 名字和绩效系统一致码？]  原来为空，就变为null； 名字和某个机构名是互相包含的关系，就去机构码；名字里面包含分行2字，就认为是所在的分行；都不符合名字不变 code也是null；

    - 手工绩效发布，部门列：某某分行或者机构层级列表中的机构；

  - 宁波分行风险借据

    - 业务：风险借据五个字段定位到多条，有两个原因：一个是字段调整，原来的金额字段会设置为0； 另一个是换部门了，一条会分为多条，这种情况总和不变(换部门这种情况，目前我们这边的逻辑还不适配，后续再说，或者只冻结一笔)；

  - 杭州分行

    - 对接分行：进入企微，要配置客户经理，且分行对应的页面开关要打开；
    - 月中离职当月不能算两个处理方式：一种查两个月（入参 分行编号 月份/工号 月份）；另一种切片表存两个月的记录；看晨辉决定怎么改吧？
    - 实绩项补录、绩效项补录页面  暂不维护：没加配置---全量还是增量；调整原因一行只有一个 不是一个实绩项一个；

  - 投产相关

    - 数智管理的帕拉迪申请下；//暂时不申请；等他们说要求切换了再切换好了[要切换的话换个svn上传，申请下中转机就好，自动化要切换下部室就好]；
      生产环境可以看到哪些制品路径？；//申请的是tcbb的svn，制品库是从tcbb同步过去的，cds的制品库就是我们在tcbb的网页看到的制品库；
      //还有自动化部署的话要切换部室；

工作时间的假最好还是不要请！！！除非当真是只有工作日，那没办法。但凡可以周六，无论如何忍一忍！！！！比如这次，去派出所正好可以成为自己早回来的理由。

以后投产前一周写不完的 直接就说写不完  要延期好了，每次搞得自己压力这么大，没必要

以后代码编写，单元测试，代码编写原则复查，仔细测试；尽量一口气完成调，然后就不再回头，中间隔断一下再温习真的还蛮难受的。

 

//对外的业务能做得好的尽量做得好一点，能做实时就尽量实时吧，不然显得你很没水平 

 

以后这种非正式形式分配的任务，一律不接，先把手上的事情做完。说实话，w是没有资格指挥我的，就直接明确回复没时间就好，不依不饶就不鸟他。



以后遇见不会说话的，不理他就好了，换个人沟通，尽量绕开，就算不得不说话，也不要和他争。没什么意义，多说一句话都是败坏自己的品德和心情，更别说发泄情绪了。



//诚然，代码编写是工作中很重要的一部分，甚至说是必不可少；但不能因此就直接否定之前的需求提出  澄清  规划设计的工作价值，难的是给这两份工作一个客观、合理的价值评估。如果你学习、领悟到技巧 经验  方法能提出好的需求，理清好的需求也是有一定价值的。



2.发展相关

0329//个人成长(之前就说技术要求不深，我就没说出来)；是不是也可以写点规则什么的？
//==规则还没写过==；
//作为银行来说，沟通能力比较重要，以后需要加强一些（大家以后的发展方向都是项目经理）；  导出功能数据脱敏（和庆哥沟通下），这一点需要注意下；   其它组（信贷之类）可能业务上的知识会多一些，反欺诈还好； ==外部需求优先，优先满足业务==，内部需求压缩下；
挑战性，其它组有新的项目的话，可以参与下（但是期待不要太高，因为毕竟是银行，技术深度要求不高），但是整个项目组是要稳定下来的；



3.与业务的沟通

//从这次的项目中，深刻意识到的事情是  最重要的事情是沟通方式，业务当面当面说清楚 自己要的指标是看到哪里的？然后就直到该找谁、如何去获取指标了。

原则上，我们不要做指标的加工，只做数据的获取；

 

4.任务划分上

能自己写尽量自己写呗，特别考虑到沟通成本；

#### 印象深的问题

- idea正常，自动化部署异常的问题(@param注解少了的问题，idea默认编译参数-p )